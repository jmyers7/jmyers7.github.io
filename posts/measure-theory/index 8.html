<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-10-17">

<title>Measure theory – john myers, ph.d.</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../img/fav.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-e70e373d709ee9d216e9a1aea6657d26.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-ccc6b90b4d1ed2bb7ba759a873171846.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-VWK3RHBGT2"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-VWK3RHBGT2', { 'anonymize_ip': true});
</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&amp;family=IBM+Plex+Sans:ital,wght@0,100..700;1,100..700&amp;family=Nunito:ital,wght@0,200..1000;1,200..1000&amp;display=swap" rel="stylesheet">
<meta name="quarto:status" content="draft">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><div id="quarto-draft-alert" class="alert alert-warning"><i class="bi bi-pencil-square"></i>Draft</div>
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">about</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../writings.html"> 
<span class="menu-text">writings</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-teaching" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">teaching</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-teaching">    
        <li>
    <a class="dropdown-item" href="../../teaching/calculus-ii-fa-25.html">
 <span class="dropdown-text">mat220 calculus II, fall 2025</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../teaching/analysis-fa-25.html">
 <span class="dropdown-text">mat347 analysis, fall 2025</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="https://www.johnmyers-phd.com/book" target="_blank"> 
<span class="menu-text">probabilistic machine learning</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jmyers7/" target="_blank"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/john-myers-phd" target="_blank"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:jmmyers25@gmail.com"> <i class="bi bi-envelope-open-fill" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#random-variables-as-information-carriers" id="toc-random-variables-as-information-carriers" class="nav-link" data-scroll-target="#random-variables-as-information-carriers">Random variables as information carriers</a></li>
  <li><a href="#example-a-coin-with-momentum" id="toc-example-a-coin-with-momentum" class="nav-link" data-scroll-target="#example-a-coin-with-momentum">Example: a coin with momentum</a></li>
  <li><a href="#hilbert-spaces-of-random-variables" id="toc-hilbert-spaces-of-random-variables" class="nav-link" data-scroll-target="#hilbert-spaces-of-random-variables">Hilbert spaces of random variables</a></li>
  <li><a href="#conditional-expectations-as-projections" id="toc-conditional-expectations-as-projections" class="nav-link" data-scroll-target="#conditional-expectations-as-projections">Conditional expectations as projections</a></li>
  <li><a href="#return-to-the-coin-flip-with-momentum" id="toc-return-to-the-coin-flip-with-momentum" class="nav-link" data-scroll-target="#return-to-the-coin-flip-with-momentum">Return to the coin flip with momentum</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#bibliography" id="toc-bibliography" class="nav-link" data-scroll-target="#bibliography">Bibliography</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Measure theory</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Information theory</div>
    <div class="quarto-category">Probability theory</div>
    <div class="quarto-category">Measure theory</div>
    <div class="quarto-category">Sigma-algebras</div>
    <div class="quarto-category">Conditional expectations</div>
    <div class="quarto-category">Hilbert spaces</div>
    <div class="quarto-category">Linear algebra</div>
    <div class="quarto-category">Python</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 17, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>In this post we explore the relationship between random variables, algebras of sets, and Hilbert spaces. We begin by showing how random variables induce algebras of observable events through their level sets, and we characterize the refinement relations between these algebras in terms of the behavior of the random variables on the atoms of pre-existing algebras. Next, we introduce the <span class="math inline">\(L^2\)</span>-spaces associated to algebras of sets, demonstrating that these spaces are Hilbert spaces with inner products defined via expectation. Finally, we connect the refinement of algebras to the nesting of their corresponding <span class="math inline">\(L^2\)</span>-spaces, providing a geometric perspective on information refinement.</p>
<div id="129d74d9" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> HTML</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sigalg.StochasticProcesses <span class="im">import</span> (</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    FirstOrderMarkovChain,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    transform_discrete_process,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    conditional_exp,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sigalg.Utilities <span class="im">import</span> print_html_df</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">"../../aux-files/custom-theme.mplstyle"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>yellow <span class="op">=</span> <span class="st">"#FFC300"</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>blue <span class="op">=</span> <span class="st">"#3399FF"</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>pink <span class="op">=</span> <span class="st">"#FF3399"</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [yellow, pink, blue]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="random-variables-as-information-carriers" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="random-variables-as-information-carriers">Random variables as information carriers</h2>
<p>First, we set the scene and recall a few basic concepts from the previous post. We let <span class="math inline">\(\Omega\)</span> be a finite set, conceptualized as the set of outcomes of an experiment. An <em>algebra of sets</em> <span class="math inline">\(\mathcal{F}\)</span> in <span class="math inline">\(\Omega\)</span> is a collection of subsets of <span class="math inline">\(\Omega\)</span> that contains <span class="math inline">\(\Omega\)</span> and is closed under complements and finite unions. Algebras capture information about which events can be observed in the experiment: if <span class="math inline">\(A \in \mathcal{F}\)</span>, then the event <span class="math inline">\(A\)</span> is observable, meaning that an observer can determine whether the outcome <span class="math inline">\(\omega \in A\)</span> or not. Algebras can be partially ordered by the refinement relation: an algebra <span class="math inline">\(\mathcal{F}\)</span> <em>refines</em> another algebra <span class="math inline">\(\mathcal{G}\)</span> if <span class="math inline">\(\mathcal{G}\subset \mathcal{F}\)</span>. In this case, <span class="math inline">\(\mathcal{F}\)</span> contains at least as much information as <span class="math inline">\(\mathcal{G}\)</span>, since every event observable in <span class="math inline">\(\mathcal{G}\)</span> is also observable in <span class="math inline">\(\mathcal{F}\)</span>.</p>
<p>As we will see in this section, functions on <span class="math inline">\(\Omega\)</span> also carry information. In particular, <em>random variables</em> are functions <span class="math inline">\(X:\Omega \to \mathbb{R}\)</span> that assign a real number to each outcome <span class="math inline">\(\omega \in \Omega\)</span>. They induce algebras through their <em>level sets</em>, which are the preimages of singletons in <span class="math inline">\(\mathbb{R}\)</span>. In what follows, it will be convenient to allow the codomain of <span class="math inline">\(X\)</span> to be an arbitrary finite-dimensional euclidean space <span class="math inline">\(\mathbb{R}^n\)</span>, not just <span class="math inline">\(\mathbb{R}\)</span>, in which case a function <span class="math inline">\(X:\Omega \to \mathbb{R}^n\)</span> is often called a <em>random vector</em>.</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="def-rv-part" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1</strong></span> Let <span class="math inline">\(X:\Omega\to \mathbb{R}^n\)</span> be a random vector on a finite set <span class="math inline">\(\Omega\)</span>. For <span class="math inline">\(x\in \mathbb{R}^n\)</span>, sets of the form</p>
<p><span class="math display">\[
X^{-1}(x) \overset{\text{def}}{=}\{ \omega \in \Omega : X(\omega)=x\}
\]</span></p>
<p>are called <em>level sets</em>.</p>
</div>
</div>
</div>
</div>
<p>As you may easily check, the nonempty level sets of a random vector <span class="math inline">\(X\)</span> partition its domain, and through this partition the random vector generates an algebra of sets in <span class="math inline">\(\Omega\)</span> denoted <span class="math inline">\(\sigma(X)\)</span>. The level sets are the <em>atoms</em> of this algebra, i.e., they are the minimal nonempty sets in <span class="math inline">\(\sigma(X)\)</span>. The algebra <span class="math inline">\(\sigma(X)\)</span> captures precisely the information an observer gains by learning the value of <span class="math inline">\(X\)</span>. If the observer knows <span class="math inline">\(X(\omega) = x\)</span>, they know that <span class="math inline">\(\omega \in X^{-1}(x)\)</span> but cannot distinguish between outcomes within this level set. Thus, <span class="math inline">\(\sigma(X)\)</span> represents the coarsest partition of <span class="math inline">\(\Omega\)</span> consistent with the information provided by <span class="math inline">\(X\)</span>.</p>
<p>Now we introduce some notation for algebras generated by multiple random vectors. Above, we’ve seen algebras generated by one random variables. In fact, we may form algebras generated by any finite number of random variables, as follows.</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="def-algebra-gen-rv" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2</strong></span> Let <span class="math inline">\(X_1,X_2,\ldots,X_m\)</span> be random vectors on a finite set <span class="math inline">\(\Omega\)</span>. The <em>algebra generated</em> by <span class="math inline">\(X_1,X_2,\ldots,X_m\)</span> is the algebra of sets in <span class="math inline">\(\Omega\)</span>, denoted by <span class="math inline">\(\sigma(X_1,X_2,\ldots,X_m)\)</span>, whose atoms are all nonempty intersections of the form <span class="math display">\[
\bigcap_{i=1}^m X_i^{-1}(x_i),
\]</span></p>
<p>where <span class="math inline">\(x_i\)</span> is a value of <span class="math inline">\(X_i\)</span> for each <span class="math inline">\(i\)</span>.</p>
</div>
</div>
</div>
</div>
<p>In fact, if we are given a finite set of random variables <span class="math inline">\(X_1,X_2,\ldots,X_m\)</span> as in the theorem, then we may form the random vector</p>
<p><span class="math display">\[
X: \Omega \to \mathbb{R}^m, \quad X(\omega) = (X_1(\omega), X_2(\omega), \ldots, X_m(\omega)).
\]</span></p>
<p>Then, as you may easily check, the algebra generated by <span class="math inline">\(X_1,X_2,\ldots,X_m\)</span> is simply the algebra generated by the random vector <span class="math inline">\(X\)</span>:</p>
<p><span class="math display">\[
\sigma(X_1,X_2,\ldots,X_m) = \sigma(X).
\]</span></p>
<p>Now, very often the set <span class="math inline">\(\Omega\)</span> comes equipped with a pre-existing algebra <span class="math inline">\(\mathcal{F}\)</span> of observable events (perhaps as part of a probability space <span class="math inline">\((\Omega,\mathcal{F},P)\)</span>). In this case, it is natural to ask how the information encoded in <span class="math inline">\(\sigma(X)\)</span> relates to that in <span class="math inline">\(\mathcal{F}\)</span>. The first possiblity is that neither algebra refines the other, meaning that <span class="math inline">\(\sigma(X)\)</span> and <span class="math inline">\(\mathcal{F}\)</span> contain different kinds of information. The other possibilities are that one algebra refines the other, meaning that one contains at least as much information as the other. The following theorem characterizes these refinement relations in terms of the behavior of <span class="math inline">\(X\)</span> on the atoms of <span class="math inline">\(\mathcal{F}\)</span>.</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-rv-refine" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1 (Random variables and refinements)</strong></span> Let <span class="math inline">\(\mathcal{F}\)</span> be an algebra of sets in a finite set <span class="math inline">\(\Omega\)</span>, and let <span class="math inline">\(X:\Omega \to \mathbb{R}^n\)</span> be a random vector.</p>
<ol type="1">
<li><p>The algebra <span class="math inline">\(\mathcal{F}\)</span> refines <span class="math inline">\(\sigma(X)\)</span> (equivalently, <span class="math inline">\(\sigma(X) \subset \mathcal{F}\)</span>) if and only if <span class="math inline">\(X\)</span> is constant on every atom in <span class="math inline">\(\mathcal{F}\)</span>.</p></li>
<li><p>The algebra <span class="math inline">\(\sigma(X)\)</span> refines <span class="math inline">\(\mathcal{F}\)</span> (equivalently, <span class="math inline">\(\mathcal{F}\subset \sigma(X)\)</span>) if and only if every atom in <span class="math inline">\(\mathcal{F}\)</span> is a union of level sets of <span class="math inline">\(X\)</span>.</p></li>
</ol>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Proof.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The algebra <span class="math inline">\(\mathcal{F}\)</span> refines <span class="math inline">\(\sigma(X)\)</span> if and only if every nonempty level set is a union of atoms in <span class="math inline">\(\mathcal{F}\)</span>. This proves the result in the first statement. A symmetric argument using the same theorem proves the second statement.</p>
</div>
</div>
</div>
<p>Random vectors satisfying the first condition in <a href="#thm-rv-refine" class="quarto-xref">Theorem&nbsp;1</a> arise frequently enough to warrant their own terminology.</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="def-measurable" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3</strong></span> Let <span class="math inline">\(\mathcal{F}\)</span> be an algebra of sets in a finite set <span class="math inline">\(\Omega\)</span>. A random vector <span class="math inline">\(X\)</span> on <span class="math inline">\(\Omega\)</span> will be called <em><span class="math inline">\(\mathcal{F}\)</span>-measurable</em> if <span class="math inline">\(\mathcal{F}\)</span> refines the algebra <span class="math inline">\(\sigma(X)\)</span>, i.e., <span class="math inline">\(\sigma(X) \subset \mathcal{F}\)</span>.</p>
</div>
</div>
</div>
</div>
<p>Returning to our coin-flipping scenario, we see that <span class="math inline">\(Y\)</span> is <em>only</em> <span class="math inline">\(\mathcal{F}_3\)</span>-measureable, since the atoms in this algebra are the only ones on which <span class="math inline">\(Y\)</span> is constant. (Of course, <span class="math inline">\(\mathcal{F}_3\)</span> is the power set of <span class="math inline">\(\Omega\)</span>.) The information afforded by <span class="math inline">\(Y\)</span> is not comparable to that of <span class="math inline">\(\mathcal{F}_1\)</span> or <span class="math inline">\(\mathcal{F}_2\)</span>, since there are no subset containments between <span class="math inline">\(\sigma(Y)\)</span> and <span class="math inline">\(\mathcal{F}_1\)</span> or <span class="math inline">\(\mathcal{F}_2\)</span>.</p>
<p>If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are both random vectors on <span class="math inline">\(\Omega\)</span>, then we may compare the information they encode by comparing their algebras <span class="math inline">\(\sigma(X)\)</span> and <span class="math inline">\(\sigma(Y)\)</span>. Then <a href="#thm-rv-refine" class="quarto-xref">Theorem&nbsp;1</a> tells us <em>when</em> one algebra refines the other, but not <em>how</em> the vectors relate. The next theorem provides this missing piece: refinement is equivalent to functional dependence.</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-functional-rep" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2 (Functional representation)</strong></span> Let <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> be two <span class="math inline">\(\mathbb{R}^n\)</span>-valued random vectors on a finite set <span class="math inline">\(\Omega\)</span>. The following statements are equivalent:</p>

<ol type="1">
<li>The algebra <span class="math inline">\(\sigma(Y)\)</span> refines <span class="math inline">\(\sigma(X)\)</span>.</li>
<li>There exists a function <span class="math inline">\(f:\mathbb{R}^n \to \mathbb{R}^n\)</span> such that <span class="math inline">\(X = f \circ Y\)</span>.</li>
</ol>
</div>
</div>
</div>
</div>
<div class="no-row-height column-margin column-container"><div class="callout-margin-content callout-margin-content-simple">
<p><a href="#thm-functional-rep" class="quarto-xref">Theorem&nbsp;2</a> holds for general measurable spaces, not just finite sets. The proof requires the Doob-Dynkin lemma and properties of <span class="math inline">\(\sigma\)</span>-algebras. See Lemma 1.14 in <span class="citation" data-cites="Kallenberg2021">Kallenberg (<a href="#ref-Kallenberg2021" role="doc-biblioref">2021</a>)</span> for the general statement and proof. Our finite setting allows a more elementary approach.</p>
</div></div><div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Proof.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Suppose that <span class="math inline">\(\sigma(Y)\)</span> refines <span class="math inline">\(\sigma(X)\)</span> and write</p>
<p><span class="math display">\[
X = \sum_{i=1}^m x_i I_{A_i} \quad \text{and} \quad Y = \sum^n_{j=1} y_j I_{B_j},
\]</span></p>
<p>where <span class="math inline">\(I_{A_i}\)</span> and <span class="math inline">\(I_{B_j}\)</span> are indicator functions for the level sets</p>
<p><span class="math display">\[
A_i = X^{-1}(x_i) \quad \text{and} \quad B_j = Y^{-1}(y_j).
\]</span></p>
<p>Then every level set <span class="math inline">\(B_j\)</span> is contained in a unique level set <span class="math inline">\(A_i\)</span>, and we may define a function</p>
<p><span class="math display">\[
h:\{y_1,\ldots,y_n\} \to \mathbb{R}
\]</span></p>
<p>by setting <span class="math inline">\(h(y_j) = x_i\)</span> if <span class="math inline">\(B_j \subset A_i\)</span>. Then, define</p>
<p><span class="math display">\[
\pi: \mathbb{R}\to \mathbb{R}, \quad \pi(y) = \sum_{j=1}^n \delta_{y_j}(y),
\]</span></p>
<p>where <span class="math inline">\(\delta_{y_j}\)</span> is a Dirac delta function. If we then set <span class="math inline">\(f = h \circ \pi\)</span> and choose <span class="math inline">\(\omega\)</span> in an arbitrary <span class="math inline">\(B_j\)</span>, we have</p>
<p><span class="math display">\[
f(Y(\omega)) = (h\circ \pi)(y_j) = h(y_j) = x_i = X(\omega).
\]</span></p>
<p>Since <span class="math inline">\(B_j\)</span> and <span class="math inline">\(\omega\)</span> were chosen arbitrarily, this proves that (1) implies (2).</p>
<p>To prove the converse, suppose that <span class="math inline">\(X = f \circ Y\)</span> for some function <span class="math inline">\(f:\mathbb{R}\to \mathbb{R}\)</span>. To prove that <span class="math inline">\(\sigma(Y)\)</span> refines <span class="math inline">\(\sigma(X)\)</span>, by <a href="#thm-rv-refine" class="quarto-xref">Theorem&nbsp;1</a> it will suffice to show that every level set of <span class="math inline">\(Y\)</span> is contained in a level set of <span class="math inline">\(X\)</span>. So, let <span class="math inline">\(y \in \mathbb{R}\)</span> and consider the level set <span class="math inline">\(B = Y^{-1}(y)\)</span>. If <span class="math inline">\(B\)</span> is nonempty, then for every <span class="math inline">\(\omega \in B\)</span>, we have <span class="math inline">\(X(\omega) = f(Y(\omega)) = f(y)\)</span>. Thus, <span class="math inline">\(B \subset X^{-1}(f(y))\)</span>, and the proof is complete.</p>
</div>
</div>
</div>
</section>
<section id="example-a-coin-with-momentum" class="level2">
<h2 class="anchored" data-anchor-id="example-a-coin-with-momentum">Example: a coin with momentum</h2>
<p>Let’s explore these ideas with a concrete example. Consider a coin-flipping experiment where the outcome at each time step depends on the previous outcomes, introducing a “momentum” or “inertia” effect. Specifically, if the last flip was heads, the coin is more likely to land heads again, and vice versa for tails. This scenario can be modeled using a Markov chain.</p>
<p>Suppose that we write <span class="math inline">\(X_t\)</span> for the result of the <span class="math inline">\(t\)</span>-th coin flip, where <span class="math inline">\(X_t = 1\)</span> represents heads and <span class="math inline">\(X_t = 0\)</span> represents tails. The first coin is unbiased, so</p>
<p><span class="math display">\[
P(X_1=1) = P(X_1 = 0) = 0.5
\]</span></p>
<p>However, the conditional probabilities for subsequent flips are given by the transition matrix</p>
<p><span class="math display">\[
\begin{bmatrix}
P(X_t=0 \mid X_{t-1}=0) &amp; P(X_t=1 \mid X_{t-1}=0) \\
P(X_t=0 \mid X_{t-1}=1) &amp; P(X_t=1 \mid X_{t-1}=1)
\end{bmatrix} =
\begin{bmatrix}
0.7 &amp; 0.3 \\
0.2 &amp; 0.8
\end{bmatrix}.
\]</span></p>
<p>Suppose that we flip the coin four times, producing a Markov chain of length <span class="math inline">\(4\)</span>. All <span class="math inline">\(2^4 = 16\)</span> possible outcomes <span class="math inline">\((X_1,X_2,X_3,X_4)\)</span> form the sample space <span class="math inline">\(\Omega\)</span> of this experiment. The probability of each outcome may be computed using the initial probabilities and the transition matrix. We implement <span class="math inline">\(\Omega\)</span> and these probabilities as a data frame:</p>
<div id="ef24f802" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># P(X_1 = 0) = 0.5, P(X_1 = 1) = 0.5</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>init_prob <span class="op">=</span> np.array([<span class="fl">0.5</span>, <span class="fl">0.5</span>])</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># P(X_{n+1} = 0 | X_n = 0) = 0.7, P(X_{n+1} = 1 | X_n = 0) = 0.3</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># P(X_{n+1} = 0 | X_n = 1) = 0.2, P(X_{n+1} = 1 | X_n = 1) = 0.8</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>transition_matrix <span class="op">=</span> np.array([[<span class="fl">0.7</span>, <span class="fl">0.3</span>], [<span class="fl">0.2</span>, <span class="fl">0.8</span>]])</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate Markov chain modeling coin flips with momentum</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>mc <span class="op">=</span> FirstOrderMarkovChain(</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    transition_matrix,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    init_prob,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the sample space</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>mc.generate_sample_space(trajectory_length<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>print_html_df(df<span class="op">=</span>mc.omega, title<span class="op">=</span><span class="st">"probability space for coin flips with momentum"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="16">
<style type="text/css">
#T_68af3 th {
  text-align: right;
  width: 80px;
}
#T_68af3_row0_col0, #T_68af3_row0_col1, #T_68af3_row0_col2, #T_68af3_row0_col3, #T_68af3_row0_col4, #T_68af3_row1_col0, #T_68af3_row1_col1, #T_68af3_row1_col2, #T_68af3_row1_col3, #T_68af3_row1_col4, #T_68af3_row2_col0, #T_68af3_row2_col1, #T_68af3_row2_col2, #T_68af3_row2_col3, #T_68af3_row2_col4, #T_68af3_row3_col0, #T_68af3_row3_col1, #T_68af3_row3_col2, #T_68af3_row3_col3, #T_68af3_row3_col4, #T_68af3_row4_col0, #T_68af3_row4_col1, #T_68af3_row4_col2, #T_68af3_row4_col3, #T_68af3_row4_col4, #T_68af3_row5_col0, #T_68af3_row5_col1, #T_68af3_row5_col2, #T_68af3_row5_col3, #T_68af3_row5_col4, #T_68af3_row6_col0, #T_68af3_row6_col1, #T_68af3_row6_col2, #T_68af3_row6_col3, #T_68af3_row6_col4, #T_68af3_row7_col0, #T_68af3_row7_col1, #T_68af3_row7_col2, #T_68af3_row7_col3, #T_68af3_row7_col4, #T_68af3_row8_col0, #T_68af3_row8_col1, #T_68af3_row8_col2, #T_68af3_row8_col3, #T_68af3_row8_col4, #T_68af3_row9_col0, #T_68af3_row9_col1, #T_68af3_row9_col2, #T_68af3_row9_col3, #T_68af3_row9_col4, #T_68af3_row10_col0, #T_68af3_row10_col1, #T_68af3_row10_col2, #T_68af3_row10_col3, #T_68af3_row10_col4, #T_68af3_row11_col0, #T_68af3_row11_col1, #T_68af3_row11_col2, #T_68af3_row11_col3, #T_68af3_row11_col4, #T_68af3_row12_col0, #T_68af3_row12_col1, #T_68af3_row12_col2, #T_68af3_row12_col3, #T_68af3_row12_col4, #T_68af3_row13_col0, #T_68af3_row13_col1, #T_68af3_row13_col2, #T_68af3_row13_col3, #T_68af3_row13_col4, #T_68af3_row14_col0, #T_68af3_row14_col1, #T_68af3_row14_col2, #T_68af3_row14_col3, #T_68af3_row14_col4, #T_68af3_row15_col0, #T_68af3_row15_col1, #T_68af3_row15_col2, #T_68af3_row15_col3, #T_68af3_row15_col4 {
  text-align: right;
  font-family: monospace;
  width: 80px;
}
</style>

<div id="T_68af3" class="quarto-float quarto-figure quarto-figure-center anchored" data-quarto-postprocess="true">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="T_68af3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: probability space for coin flips with momentum
</figcaption>
<div aria-describedby="T_68af3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="T_68af3" class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th id="T_68af3_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">X1</th>
<th id="T_68af3_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">X2</th>
<th id="T_68af3_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">X3</th>
<th id="T_68af3_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">X4</th>
<th id="T_68af3_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_68af3_row0_col0" class="data row0 col0">0</td>
<td id="T_68af3_row0_col1" class="data row0 col1">0</td>
<td id="T_68af3_row0_col2" class="data row0 col2">0</td>
<td id="T_68af3_row0_col3" class="data row0 col3">0</td>
<td id="T_68af3_row0_col4" class="data row0 col4">0.171500</td>
</tr>
<tr class="even">
<td id="T_68af3_row1_col0" class="data row1 col0">0</td>
<td id="T_68af3_row1_col1" class="data row1 col1">0</td>
<td id="T_68af3_row1_col2" class="data row1 col2">0</td>
<td id="T_68af3_row1_col3" class="data row1 col3">1</td>
<td id="T_68af3_row1_col4" class="data row1 col4">0.073500</td>
</tr>
<tr class="odd">
<td id="T_68af3_row2_col0" class="data row2 col0">0</td>
<td id="T_68af3_row2_col1" class="data row2 col1">0</td>
<td id="T_68af3_row2_col2" class="data row2 col2">1</td>
<td id="T_68af3_row2_col3" class="data row2 col3">0</td>
<td id="T_68af3_row2_col4" class="data row2 col4">0.021000</td>
</tr>
<tr class="even">
<td id="T_68af3_row3_col0" class="data row3 col0">0</td>
<td id="T_68af3_row3_col1" class="data row3 col1">0</td>
<td id="T_68af3_row3_col2" class="data row3 col2">1</td>
<td id="T_68af3_row3_col3" class="data row3 col3">1</td>
<td id="T_68af3_row3_col4" class="data row3 col4">0.084000</td>
</tr>
<tr class="odd">
<td id="T_68af3_row4_col0" class="data row4 col0">0</td>
<td id="T_68af3_row4_col1" class="data row4 col1">1</td>
<td id="T_68af3_row4_col2" class="data row4 col2">0</td>
<td id="T_68af3_row4_col3" class="data row4 col3">0</td>
<td id="T_68af3_row4_col4" class="data row4 col4">0.021000</td>
</tr>
<tr class="even">
<td id="T_68af3_row5_col0" class="data row5 col0">0</td>
<td id="T_68af3_row5_col1" class="data row5 col1">1</td>
<td id="T_68af3_row5_col2" class="data row5 col2">0</td>
<td id="T_68af3_row5_col3" class="data row5 col3">1</td>
<td id="T_68af3_row5_col4" class="data row5 col4">0.009000</td>
</tr>
<tr class="odd">
<td id="T_68af3_row6_col0" class="data row6 col0">0</td>
<td id="T_68af3_row6_col1" class="data row6 col1">1</td>
<td id="T_68af3_row6_col2" class="data row6 col2">1</td>
<td id="T_68af3_row6_col3" class="data row6 col3">0</td>
<td id="T_68af3_row6_col4" class="data row6 col4">0.024000</td>
</tr>
<tr class="even">
<td id="T_68af3_row7_col0" class="data row7 col0">0</td>
<td id="T_68af3_row7_col1" class="data row7 col1">1</td>
<td id="T_68af3_row7_col2" class="data row7 col2">1</td>
<td id="T_68af3_row7_col3" class="data row7 col3">1</td>
<td id="T_68af3_row7_col4" class="data row7 col4">0.096000</td>
</tr>
<tr class="odd">
<td id="T_68af3_row8_col0" class="data row8 col0">1</td>
<td id="T_68af3_row8_col1" class="data row8 col1">0</td>
<td id="T_68af3_row8_col2" class="data row8 col2">0</td>
<td id="T_68af3_row8_col3" class="data row8 col3">0</td>
<td id="T_68af3_row8_col4" class="data row8 col4">0.049000</td>
</tr>
<tr class="even">
<td id="T_68af3_row9_col0" class="data row9 col0">1</td>
<td id="T_68af3_row9_col1" class="data row9 col1">0</td>
<td id="T_68af3_row9_col2" class="data row9 col2">0</td>
<td id="T_68af3_row9_col3" class="data row9 col3">1</td>
<td id="T_68af3_row9_col4" class="data row9 col4">0.021000</td>
</tr>
<tr class="odd">
<td id="T_68af3_row10_col0" class="data row10 col0">1</td>
<td id="T_68af3_row10_col1" class="data row10 col1">0</td>
<td id="T_68af3_row10_col2" class="data row10 col2">1</td>
<td id="T_68af3_row10_col3" class="data row10 col3">0</td>
<td id="T_68af3_row10_col4" class="data row10 col4">0.006000</td>
</tr>
<tr class="even">
<td id="T_68af3_row11_col0" class="data row11 col0">1</td>
<td id="T_68af3_row11_col1" class="data row11 col1">0</td>
<td id="T_68af3_row11_col2" class="data row11 col2">1</td>
<td id="T_68af3_row11_col3" class="data row11 col3">1</td>
<td id="T_68af3_row11_col4" class="data row11 col4">0.024000</td>
</tr>
<tr class="odd">
<td id="T_68af3_row12_col0" class="data row12 col0">1</td>
<td id="T_68af3_row12_col1" class="data row12 col1">1</td>
<td id="T_68af3_row12_col2" class="data row12 col2">0</td>
<td id="T_68af3_row12_col3" class="data row12 col3">0</td>
<td id="T_68af3_row12_col4" class="data row12 col4">0.056000</td>
</tr>
<tr class="even">
<td id="T_68af3_row13_col0" class="data row13 col0">1</td>
<td id="T_68af3_row13_col1" class="data row13 col1">1</td>
<td id="T_68af3_row13_col2" class="data row13 col2">0</td>
<td id="T_68af3_row13_col3" class="data row13 col3">1</td>
<td id="T_68af3_row13_col4" class="data row13 col4">0.024000</td>
</tr>
<tr class="odd">
<td id="T_68af3_row14_col0" class="data row14 col0">1</td>
<td id="T_68af3_row14_col1" class="data row14 col1">1</td>
<td id="T_68af3_row14_col2" class="data row14 col2">1</td>
<td id="T_68af3_row14_col3" class="data row14 col3">0</td>
<td id="T_68af3_row14_col4" class="data row14 col4">0.064000</td>
</tr>
<tr class="even">
<td id="T_68af3_row15_col0" class="data row15 col0">1</td>
<td id="T_68af3_row15_col1" class="data row15 col1">1</td>
<td id="T_68af3_row15_col2" class="data row15 col2">1</td>
<td id="T_68af3_row15_col3" class="data row15 col3">1</td>
<td id="T_68af3_row15_col4" class="data row15 col4">0.256000</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
<p><br></p>
<p>We can simulate longer chains of coin flips using this Markov chain model. Below, we simulate a single trajectory of length 50 and plot the individual coin flip outcomes as well as the cumulative number of heads over time.</p>
<div id="354e5ec8" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate a single trajectory of 50 coin flips with the Markov chain model</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>mc.simulate(trajectory_length<span class="op">=</span><span class="dv">50</span>, num_trajectories<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a figure with two side-by-side subplots</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">4</span>))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Left subplot: Plot individual coin flip outcomes (0s and 1s) over time</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>mc.plot_simulations(ax<span class="op">=</span>axes[<span class="dv">0</span>], plot_kwargs<span class="op">=</span>{<span class="st">"marker"</span>: <span class="st">"o"</span>})</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">"number of flips"</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">"heads (1) or tails (0)"</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">"individual coin flip outcomes"</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a transformed process that shows cumulative heads count</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co"># This applies the cumsum transformation to the original Markov chain</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>cum_process <span class="op">=</span> transform_discrete_process(mc, <span class="kw">lambda</span> omega: omega.cumsum(axis<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate must be called on the source process before calling on transformed process</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Since mc.simulate() was already called above, this will transform those trajectories</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>cum_process.simulate()</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Right subplot: Plot the cumulative number of heads over time</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>cum_process.plot_simulations(ax<span class="op">=</span>axes[<span class="dv">1</span>], plot_kwargs<span class="op">=</span>{<span class="st">"marker"</span>: <span class="st">"o"</span>})</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">"number of flips"</span>)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">"number of heads"</span>)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">"cumulative number of heads"</span>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Add overall title and adjust layout to prevent overlap</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">"coin flip simulation with momentum"</span>)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-4-output-1.png" class="quarto-figure quarto-figure-center figure-img" width="788" height="395"></p>
</figure>
</div>
</div>
</div>
<p>We can also simulate multiple trajectories to see how the number of heads varies across different runs of the experiment. Below, we simulate 10 chains of length 250 and plot the cumulative number of heads for each simulation.</p>
<div id="dba5ea0e" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset the chain length and simulate 10 chains</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>mc.simulate(trajectory_length<span class="op">=</span><span class="dv">250</span>, num_trajectories<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a transformed process for cumulative heads count</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>cum_process.simulate()</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the number of heads over time for each simulation</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>_, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>cum_process.plot_simulations(ax<span class="op">=</span>ax, colors<span class="op">=</span>colors)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"10 coin flip simulations with momentum"</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"number of flips"</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"number of heads"</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-5-output-1.png" class="quarto-figure quarto-figure-center figure-img" width="688" height="488"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="hilbert-spaces-of-random-variables" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="hilbert-spaces-of-random-variables">Hilbert spaces of random variables</h2>
<p>We’ve seen how random variables encode information through the algebras they generate. But random variables also have numerical values, which allows us to perform algebraic operations: we can add them, multiply them by scalars, and compute their expected values. This algebraic structure becomes particularly rich when we introduce an inner product, turning the space of random variables into a Hilbert space. This latter structure provides a geometric perspective on random variables, where concepts like orthogonality, projection, and distance become meaningful. This perspective will prove essential for understanding conditional expectation, which emerges naturally as orthogonal projection onto subspaces determined by algebras.</p>
<p>First, we recall that the pointwise sum and scalar multiple of random variables are again random variables, and these operations have the usual properties of commutativity, associativity, <em>etc</em>. Thus, the set of all random variables on a finite set <span class="math inline">\(\Omega\)</span> forms a vector space over the real numbers <span class="math inline">\(\mathbb{R}\)</span>. The subspaces of this vector space that are most relevant to us are those consisting of random variables that are measurable with respect to a given algebra of sets.</p>
<p>We shall also need the concept of <em>expectation</em> of a measurable random variable. If <span class="math inline">\((\Omega,\mathcal{F},P)\)</span> is a finite probability space and <span class="math inline">\(X:\Omega \to \mathbb{R}\)</span> is a random variable, then the <em>expectation</em> of <span class="math inline">\(X\)</span> is defined as</p>
<p><span id="eq-def-expectation"><span class="math display">\[
E(X) \overset{\text{def}}{=}\int_\Omega X \ dP,
\tag{1}\]</span></span></p>
<p>where the integral on the right is the Lebesgue integral with respect to the probability measure <span class="math inline">\(P\)</span>. In the finite setting, this integral reduces to the familiar weighted average of the values of the random variable, where the weights are the probabilities of the level sets of <span class="math inline">\(X\)</span>:</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>The benefit of using the Lebesgue integral (<a href="#eq-def-expectation" class="quarto-xref">1</a>) to define expectation is that it generalizes directly to “continuous” sample spaces equipped with probability measures on <span class="math inline">\(\sigma\)</span>-algebras. In that more general setting, expectation cannot be defined as a simple finite weighted sum as in (<a href="#eq-expectation-finite" class="quarto-xref">2</a>), though it remains a Lebesgue integral. Thus, the Lebesgue integral allows us to treat both discrete and continuous probability theory in a unified manner.</p>
</div></div><p><span id="eq-expectation-finite"><span class="math display">\[
\int_\Omega X \ dP = \sum_{i=1}^m x_i P(A_i),
\tag{2}\]</span></span></p>
<p>where <span class="math inline">\(A_1, A_2, \ldots, A_m\)</span> are the level sets of <span class="math inline">\(X\)</span> and <span class="math inline">\(x_i\)</span> is the value of <span class="math inline">\(X\)</span> on <span class="math inline">\(A_i\)</span>. Note that in order for the probability <span class="math inline">\(P(A_i)\)</span> to be defined, we must have <span class="math inline">\(A_i \in \mathcal{F}\)</span>, which is guaranteed if <span class="math inline">\(X\)</span> is <span class="math inline">\(\mathcal{F}\)</span>-measurable.</p>
<p>Finally, two <span class="math inline">\(\mathcal{F}\)</span>-measurable random variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> on <span class="math inline">\((\Omega,\mathcal{F},P)\)</span> will be said to be <em>equal almost surely</em> if</p>
<p><span class="math display">\[
P(\{\omega \in \Omega : X(\omega) \neq Y(\omega)\}) = 0.
\]</span></p>
<p>Almost sure equality is an equivalence relation on the set of <span class="math inline">\(\mathcal{F}\)</span>-measurable random variables.</p>
<p>With these ingredients in place, we may now define the <span class="math inline">\(L^2\)</span>-space associated to an algebra of sets on a finite sample space.</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="def-L2" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4</strong></span> &nbsp;</p>

<p>Let <span class="math inline">\((\Omega,\mathcal{F},P)\)</span> be a finite probability space. We write <span class="math inline">\(L^2(\Omega,\mathcal{F},P)\)</span> for the set of all <span class="math inline">\(\mathcal{F}\)</span>-measurable random variables <span class="math inline">\(X:\Omega \to \mathbb{R}\)</span>, where two random variables are identified if they are equal almost surely. When the set <span class="math inline">\(\Omega\)</span> and the measure <span class="math inline">\(P\)</span> are understood from context, we will abbreviate <span class="math inline">\(L^2(\Omega,\mathcal{F},P)\)</span> as <span class="math inline">\(L^2(\mathcal{F})\)</span>.</p>
</div>
</div>
</div>
</div>
<div class="no-row-height column-margin column-container"><div class="callout-margin-content callout-margin-content-simple">
<p>The <span class="math inline">\(L^2\)</span> notation is borrowed from the case of a general sample space <span class="math inline">\(\Omega\)</span> equipped with a probability measure <span class="math inline">\(P\)</span> on a <span class="math inline">\(\sigma\)</span>-algebra <span class="math inline">\(\mathcal{F}\)</span>. In that case, <span class="math inline">\(L^2(\Omega,\mathcal{F},P)\)</span> consists of all (equivalence classes of) <span class="math inline">\(\mathcal{F}\)</span>-measurable random variables <span class="math inline">\(X:\Omega \to \mathbb{R}\)</span> such that <span class="math inline">\(E(X^2) &lt; \infty\)</span>. In our finite setting, this condition on the expectation of <span class="math inline">\(X^2\)</span> is automatically satisfied.</p>
</div></div><p>So, technically <span class="math inline">\(L^2(\mathcal{F})\)</span> is a set of equivalence classes of <span class="math inline">\(\mathcal{F}\)</span>-measurable random variables, but for ease of exposition and notation we will often refer to elements of <span class="math inline">\(L^2(\mathcal{F})\)</span> as if they were random variables themselves. This will not cause too much confusion.</p>
<p>One should check that <span class="math inline">\(L^2(\mathcal{F})\)</span> is indeed a vector subspace of the vector space of <em>all</em> random variables on <span class="math inline">\(\Omega\)</span>, which amounts to checking that sums and scalar multiples of <span class="math inline">\(\mathcal{F}\)</span>-measurable random variables are again <span class="math inline">\(\mathcal{F}\)</span>-measurable. We will leave this task to the interested reader.</p>
<p>Beyond inducing equivalence classes under almost sure equality, the probability measure <span class="math inline">\(P\)</span> plays no role in the definition of <span class="math inline">\(L^2(\mathcal{F})\)</span> itself. However, it does define an inner product on this space via expectation:</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-inner-prod" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3 (<span class="math inline">\(L^2\)</span>-spaces are Hilbert spaces)</strong></span> &nbsp;</p>

<p>Let <span class="math inline">\((\Omega,\mathcal{F},P)\)</span> be a finite probability space. The map <span class="math display">\[
\langle -, - \rangle : L^2(\mathcal{F}) \times L^2(\mathcal{F}) \to \mathbb{R}, \quad \langle X, Y \rangle = E(XY)
\]</span> defines an inner product on <span class="math inline">\(L^2(\mathcal{F})\)</span>.</p>
</div>
</div>
</div>
</div>
<div class="no-row-height column-margin column-container"><div class="callout-margin-content callout-margin-content-simple">
<p>A <em>Hilbert space</em> is a complete inner product space. Since <span class="math inline">\(L^2(\mathcal{F})\)</span> is finite-dimensional (see below), it is automatically complete, so the existence of an inner product suffices to make it a Hilbert space.</p>
</div></div><p>Using the Lebesgue integral notation, the inner product can be written as</p>
<p><span id="eq-inner-prod-integral"><span class="math display">\[
\langle X, Y \rangle = \int_\Omega XY \ dP.
\tag{3}\]</span></span></p>
<p>But if we write <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> as linear combinations of indicator functions,</p>
<p><span class="math display">\[
X = \sum_{i=1}^m x_i I_{A_i} \quad \text{and} \quad Y = \sum_{j=1}^n y_j I_{B_j}
\]</span></p>
<p>where <span class="math inline">\(A_i\)</span> and <span class="math inline">\(B_j\)</span> are the level sets of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, respectively, then (<a href="#eq-inner-prod-integral" class="quarto-xref">3</a>) becomes</p>
<p><span class="math display">\[
\langle X, Y \rangle = \sum_{i,j} x_i y_j P(A_i \cap B_j).
\]</span></p>
<p>One should check that <span class="math inline">\(\langle -, -\rangle\)</span> satisfies the properties of an inner product: linearity in the first argument, symmetry, and positive-definiteness. Again, we shall leave this task to the interested reader. We only note that the proof of positive-definiteness involves showing that <span class="math inline">\(\langle X,X\rangle=0\)</span> if and only if <span class="math inline">\(X\)</span> is almost surely equal to the zero random variable. Remember that elements in <span class="math inline">\(L^2(\mathcal{F})\)</span> are equivalence classes under almost sure equality!</p>
<p>The inner product induces a norm</p>
<p><span class="math display">\[
\|X\|_2 = \sqrt{\langle X, X \rangle} = \sqrt{E(X^2)},
\]</span></p>
<p>which measures the “magnitude” of a random variable. This is precisely the so-called <em><span class="math inline">\(L^2\)</span>-norm</em>, and the corresponding metric <span class="math inline">\(d(X, Y) = \|X - Y\|\)</span> measures the mean-squared distance between random variables. In statistics, this is the <em>root mean squared error</em> (<em>RMSE</em>) between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</p>
<p>When algebras are nested, their corresponding <span class="math inline">\(L^2\)</span>-spaces are nested as well:</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-nested-subspaces" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4</strong></span> Let <span class="math inline">\((\Omega, \mathcal{F}, P)\)</span> be a finite probability space. If <span class="math inline">\(\mathcal{G} \subset \mathcal{H}\)</span> are two subalgebras of <span class="math inline">\(\mathcal{F}\)</span>, then <span class="math display">\[
L^2(\mathcal{G}) \subset L^2(\mathcal{H}) \subset L^2(\mathcal{F}).
\]</span></p>
<p>Moreover, these subset inclusions are ones of vector subspaces.</p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Proof.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Since <span class="math inline">\(\mathcal{G} \subset \mathcal{H}\)</span>, every <span class="math inline">\(\mathcal{G}\)</span>-measurable random variable is also <span class="math inline">\(\mathcal{H}\)</span>-measurable. Thus, <span class="math inline">\(L^2(\mathcal{G}) \subset L^2(\mathcal{H})\)</span>. A symmetric argument shows that <span class="math inline">\(L^2(\mathcal{H}) \subset L^2(\mathcal{F})\)</span>. The fact that these inclusions are ones of vector subspaces follows from the fact that sums and scalar multiples of measurable random variables are measurable with respect to the same algebra.</p>
</div>
</div>
</div>
<p>This geometric picture connects directly to information refinement: as algebras refine (capturing more information), their <span class="math inline">\(L^2\)</span>-spaces expand in kind (allowing more functions to be represented). Applied to our coin-flip example the nested sequence</p>
<p><span class="math display">\[
\mathcal{F}_1 \subset \mathcal{F}_2 \subset \mathcal{F}_3
\]</span></p>
<p>induces a nested sequence</p>
<p><span class="math display">\[
L^2(\mathcal{F}_1) \subset L^2(\mathcal{F}_2) \subset L^2(\mathcal{F}_3)
\]</span></p>
<p>of <span class="math inline">\(L^2\)</span>-spaces, where each larger subspace represents more refined information about the outcomes.</p>
<p>Finally, we note that the <span class="math inline">\(L^2\)</span>-spaces associated to algebras have particularly simple and useful orthogonal bases, consisting of indicator functions of the atoms of the algebra. Issues arise when atoms have zero probability, but these are easily handled by working with equivalence classes under almost sure equality.</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-basis-L2" class="theorem">
<p><span class="theorem-title"><strong>Theorem 5 (Bases of <span class="math inline">\(L^2\)</span>-spaces)</strong></span> Let <span class="math inline">\((\Omega,\mathcal{F},P)\)</span> be a finite probability space, let <span class="math inline">\(\mathcal{G}\)</span> be a subalgebra of <span class="math inline">\(\mathcal{F}\)</span>, and let <span class="math inline">\(B_1, B_2, \ldots, B_m\)</span> be the atoms of <span class="math inline">\(\mathcal{G}\)</span> with positive probability.</p>
<ol type="1">
<li><p>The indicator functions <span class="math inline">\(I_{B_1}, I_{B_2}, \ldots, I_{B_m}\)</span> form an orthogonal basis of <span class="math inline">\(L^2(\mathcal{G})\)</span>.</p></li>
<li><p>The <span class="math inline">\(L^2\)</span>-norm of <span class="math inline">\(I_{B_i}\)</span> is <span class="math inline">\(\sqrt{P(B_i)}\)</span>.</p></li>
<li><p>The vector space dimension of <span class="math inline">\(L^2(\mathcal{G})\)</span> is equal to the number of atoms in <span class="math inline">\(\mathcal{G}\)</span> with positive probability.</p></li>
</ol>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Proof.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Suppose that we write</p>
<p><span class="math display">\[
B_1,B_2,\ldots,B_m, B_{m+1},B_{m+2},\ldots,B_n,
\]</span></p>
<p>where the sets <span class="math inline">\(B_{m+1},B_{m+2},\ldots,B_n\)</span> are the atoms of <span class="math inline">\(\mathcal{G}\)</span> with zero probability (which may not exist). Let <span class="math inline">\(X\in L^2(\mathcal{G})\)</span> be a random variable. Since <span class="math inline">\(X\)</span> is <span class="math inline">\(\mathcal{G}\)</span>-measurable, it is constant on each atom in <span class="math inline">\(\mathcal{G}\)</span>. Thus, we may write</p>
<p><span class="math display">\[
X = \sum_{i=1}^n x_i I_{B_i},
\]</span></p>
<p>for some values <span class="math inline">\(x_i \in \mathbb{R}\)</span> (not necessarily distinct). However, since <span class="math inline">\(P(B_i) = 0\)</span> for <span class="math inline">\(i = m+1, m+2, \ldots, n\)</span>, we have</p>
<p><span class="math display">\[
X = \sum_{i=1}^m x_i I_{B_i}
\]</span></p>
<p>almost surely. Thus, since elements in <span class="math inline">\(L^2(\mathcal{G})\)</span> are technically equivalence classes under almost sure equality, we have that <span class="math inline">\(X\)</span> is a linear combination of the indicator functions <span class="math inline">\(I_{B_1}, I_{B_2}, \ldots, I_{B_m}\)</span>. Thus, these indicator functions span <span class="math inline">\(L^2(\mathcal{G})\)</span>. To see that they are orthogonal, we suppose <span class="math inline">\(i\neq j\)</span>. Then, <span class="math inline">\(B_i \cap B_j =\emptyset\)</span>, and so</p>
<p><span class="math display">\[
\langle I_{B_i}, I_{B_j} \rangle = E(I_{B_i} I_{B_j}) = E(I_{B_i\cap B_j})= E(0) = 0.
\]</span></p>
<p>Orthogonality implies linear independence, so the proof is complete.</p>
</div>
</div>
</div>
</section>
<section id="conditional-expectations-as-projections" class="level2">
<h2 class="anchored" data-anchor-id="conditional-expectations-as-projections">Conditional expectations as projections</h2>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="def-conditional-expectation" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 5</strong></span> Let <span class="math inline">\((\Omega, \mathcal{F}, P)\)</span> be a finite probability space, <span class="math inline">\(\mathcal{G} \subset \mathcal{F}\)</span> a subalgebra, and <span class="math inline">\(X \in L^2(\mathcal{F})\)</span> a random variable. A <em>conditional expectation</em> of <span class="math inline">\(X\)</span> given <span class="math inline">\(\mathcal{G}\)</span> is a random variable <span class="math inline">\(E(X\mid \mathcal{G}) \in L^2(\mathcal{G})\)</span> such that</p>
<p><span id="eq-averaging-property"><span class="math display">\[
\int_B X \ dP = \int_B E(X \mid \mathcal{G}) \ dP.
\tag{4}\]</span></span></p>
<p>for all <span class="math inline">\(B \in \mathcal{G}\)</span>. This is called the <em>averaging property</em> of conditional expectation.</p>
</div>
</div>
</div>
</div>
<p>Any two conditional expectations of <span class="math inline">\(X\)</span> given <span class="math inline">\(\mathcal{G}\)</span> are almost surely equal, so the conditional expectation is unique up to almost sure equality. A particular choice of conditional expectation is called a <em>version</em>.</p>
<p>The averaging property (<a href="#eq-averaging-property" class="quarto-xref">4</a>) defines conditional expectation abstractly, but doesn’t immediately suggest how to compute it. The key insight is that this property has a geometric interpretation. To uncover it, we rewrite the averaging property as</p>
<p><span class="math display">\[
\int_\Omega \left[X - E(X \mid \mathcal{G})\right] I_B \ dP = 0,
\]</span></p>
<p>which, using the inner product from <a href="#thm-inner-prod" class="quarto-xref">Theorem&nbsp;3</a>, becomes</p>
<p><span class="math display">\[
\langle X - E(X \mid \mathcal{G}), I_B \rangle = 0.
\]</span></p>
<p>Since the indicator functions <span class="math inline">\(\{I_B : B \in \mathcal{G}\}\)</span> span <span class="math inline">\(L^2(\mathcal{G})\)</span> (by <a href="#thm-basis-L2" class="quarto-xref">Theorem&nbsp;5</a>), the residual <span class="math inline">\(X - E(X \mid \mathcal{G})\)</span> is orthogonal to every element of <span class="math inline">\(L^2(\mathcal{G})\)</span>. Thus, conditional expectation <span class="math inline">\(E(X\mid \mathcal{G})\)</span> is characterized as the orthogonal projection of <span class="math inline">\(X\)</span> onto the subspace <span class="math inline">\(L^2(\mathcal{G})\)</span>.</p>
<p>Computing this projection is straightforward. Let <span class="math inline">\(B_1,B_2,\ldots,B_m\)</span> be the atoms of <span class="math inline">\(\mathcal{G}\)</span> with positive probability. By <a href="#thm-basis-L2" class="quarto-xref">Theorem&nbsp;5</a>, the normalized indicator functions</p>
<p><span class="math display">\[
\frac{I_{B_1}}{\sqrt{P(B_1)}}, \frac{I_{B_2}}{\sqrt{P(B_2)}}, \ldots, \frac{I_{B_m}}{\sqrt{P(B_m)}}
\]</span></p>
<p>form an orthonormal basis of <span class="math inline">\(L^2(\mathcal{G})\)</span>. The conditional expectation of <span class="math inline">\(X\)</span> given <span class="math inline">\(\mathcal{G}\)</span> is the orthogonal projection onto this basis:</p>
<p><span class="math display">\[
E(X\mid \mathcal{G}) = \sum_{i=1}^m \left\langle X, \frac{I_{B_i}}{\sqrt{P(B_i)}} \right\rangle \frac{I_{B_i}}{\sqrt{P(B_i)}}.
\]</span></p>
<p>Simplifying using the definition of the inner product yields</p>
<p><span id="eq-cond-exp-compute"><span class="math display">\[
E(X\mid \mathcal{G}) = \sum_{i=1}^m \frac{1}{P(B_i)}\left(\int_{B_i} X \ dP \right)I_{B_i}.
\tag{5}\]</span></span></p>
<p>To evaluate the integrals in this formula, we write <span class="math inline">\(X\)</span> in terms of its level sets:</p>
<p><span class="math display">\[
X = \sum_{j=1}^n x_j I_{A_j},
\]</span></p>
<p>where <span class="math inline">\(A_1,A_2,\ldots,A_n\)</span> are the level sets of <span class="math inline">\(X\)</span>. Then</p>
<p><span class="math display">\[
\int_{B_i} X \ dP = \sum_{j=1}^n x_j P(A_j \cap B_i).
\]</span></p>
<p>Substituting into (<a href="#eq-cond-exp-compute" class="quarto-xref">5</a>) gives an explicit formula in terms of conditional probabilities:</p>
<p><span id="eq-cond-exp-compute-2"><span class="math display">\[
E(X\mid \mathcal{G}) = \sum_{i=1}^m \left(\sum_{j=1}^n x_j P(A_j \mid B_i)\right)I_{B_i}
\tag{6}\]</span></span></p>
<p>where <span class="math inline">\(P(A_j \mid B_i) = P(A_j \cap B_i)/P(B_i)\)</span> is the conditional probability of <span class="math inline">\(A_j\)</span> given <span class="math inline">\(B_i\)</span>. This formula connects our geometric framework to the elementary definition of conditional probability.</p>
<p>We summarize this projection interpretation in the following theorem:</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-cond-exp-proj" class="theorem">
<p><span class="theorem-title"><strong>Theorem 6 (Conditional expectation as orthogonal projection)</strong></span> Let <span class="math inline">\((\Omega, \mathcal{F}, P)\)</span> be a finite probability space, <span class="math inline">\(\mathcal{G} \subset \mathcal{F}\)</span> a subalgebra, and <span class="math inline">\(X \in L^2(\mathcal{F})\)</span> a random variable. Then, the orthogonal projection of <span class="math inline">\(X\)</span> onto the subspace <span class="math inline">\(L^2(\mathcal{G})\)</span> is a conditional expectation of <span class="math inline">\(X\)</span> given <span class="math inline">\(\mathcal{G}\)</span>. This projection is given by <a href="#eq-cond-exp-compute-2" class="quarto-xref">Equation&nbsp;6</a>.</p>
</div>
</div>
</div>
</div>
<p>So, given an <span class="math inline">\(\mathcal{F}\)</span>-measurable random variable <span class="math inline">\(X\)</span> and a coarser algebra <span class="math inline">\(\mathcal{G}\)</span>, we may trivially write</p>
<p><span class="math display">\[
X = E(X\mid \mathcal{G}) + \left[X - E(X \mid \mathcal{G})\right].
\]</span></p>
<p>This decomposition gives us two components: a <span class="math inline">\(\mathcal{G}\)</span>-measurable part <span class="math inline">\(E(X\mid \mathcal{G})\)</span> that captures all information in <span class="math inline">\(X\)</span> knowable from <span class="math inline">\(\mathcal{G}\)</span>, and a residual <span class="math inline">\(X - E(X \mid \mathcal{G})\)</span> orthogonal to every <span class="math inline">\(\mathcal{G}\)</span>-measurable random variable, representing pure noise relative to <span class="math inline">\(\mathcal{G}\)</span>.</p>
<p>In the case that <span class="math inline">\(\mathcal{G}= \{\emptyset, \Omega\}\)</span> is the trivial algebra, we have</p>
<p><span class="math display">\[
E(X \mid \mathcal{G}) = E(X),
\]</span></p>
<p>the constant random variable (taking value <span class="math inline">\(E(X)\)</span> everywhere). The trivial algebra represents having no information at all, so the best prediction of <span class="math inline">\(X\)</span> without any information is simply its expectation.</p>
<p>The fact that <span class="math inline">\(E(X \mid \mathcal{G})\)</span> is the “best” <span class="math inline">\(\mathcal{G}\)</span>-measurable approximation to <span class="math inline">\(X\)</span> can be made numerically precise, as in the following theorem:</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-best-approx" class="theorem">
<p><span class="theorem-title"><strong>Theorem 7 (Best <span class="math inline">\(L^2\)</span>-approximation)</strong></span> Let <span class="math inline">\((\Omega, \mathcal{F}, P)\)</span> be a finite probability space, <span class="math inline">\(\mathcal{G} \subset \mathcal{F}\)</span> a subalgebra, and <span class="math inline">\(X \in L^2(\mathcal{F})\)</span> a random variable. Then,</p>
<p><span class="math display">\[
E\left[(X - E(X \mid \mathcal{G}))^2\right] = \min_{Y \in L^2(\mathcal{G})} E\left[(X - Y)^2\right].
\]</span></p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Proof.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This follows directly from the fact that orthogonal projection minimizes distance in inner product spaces. See, for example, Proposition 6.36 in <span class="citation" data-cites="Axler1997">(<a href="#ref-Axler1997" role="doc-biblioref">Axler 1997</a>)</span>.</p>
</div>
</div>
</div>
<p>Beyond optimality, the projection interpretation of conditional expectation immediately yields several other important properties, which we now develop.</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-linearity" class="theorem">
<p><span class="theorem-title"><strong>Theorem 8 (Linearity of conditional expectation)</strong></span> Let <span class="math inline">\((\Omega, \mathcal{F}, P)\)</span> be a finite probability space, <span class="math inline">\(\mathcal{G} \subset \mathcal{F}\)</span> a subalgebra, and <span class="math inline">\(X, Y \in L^2(\mathcal{F})\)</span> random variables. For any scalars <span class="math inline">\(a,b \in \mathbb{R}\)</span>, we have <span class="math display">\[
E(aX + bY \mid \mathcal{G}) = a E(X \mid \mathcal{G}) + b E(Y \mid \mathcal{G})
\]</span></p>
<p>almost surely.</p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Proof.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Choose the version of conditional expectation given by orthogonal projection onto <span class="math inline">\(L^2(\mathcal{G})\)</span> as in <a href="#thm-cond-exp-proj" class="quarto-xref">Theorem&nbsp;6</a>. Since orthogonal projection is linear, the desired result follows immediately.</p>
</div>
</div>
</div>
<p>Linearity tells us that conditional expectation behaves well under linear combinations. But what happens when we condition on the product <span class="math inline">\(XY\)</span> of two random variables? If <span class="math inline">\(Y\)</span> is already <span class="math inline">\(\mathcal{G}\)</span>-measurable, then <span class="math inline">\(Y\)</span> is “known” given the information in <span class="math inline">\(\mathcal{G}\)</span>, so it should factor out of the conditional expectation. This intuition is formalized by the following property:</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-pull-out" class="theorem">
<p><span class="theorem-title"><strong>Theorem 9 (Pull-out property)</strong></span> Let <span class="math inline">\((\Omega, \mathcal{F}, P)\)</span> be a finite probability space, <span class="math inline">\(\mathcal{G} \subset \mathcal{F}\)</span> a subalgebra, and <span class="math inline">\(X \in L^2(\mathcal{F})\)</span> a random variable. If <span class="math inline">\(Y\)</span> is a <span class="math inline">\(\mathcal{G}\)</span>-measurable random variable,</p>
<p><span class="math display">\[
E(XY \mid \mathcal{G}) = Y E(X \mid \mathcal{G}).
\]</span></p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Proof.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We will prove that the random variable <span class="math inline">\(Y E(X \mid \mathcal{G})\)</span> has the defining property of a conditional expectation of <span class="math inline">\(XY\)</span> given <span class="math inline">\(\mathcal{G}\)</span>. To this end, we let <span class="math inline">\(B\)</span> be a set in <span class="math inline">\(\mathcal{G}\)</span>. Then <span class="math inline">\(YI_B\)</span> is <span class="math inline">\(\mathcal{G}\)</span>-measurable, so that if we choose the version of <span class="math inline">\(E(X\mid \mathcal{G})\)</span> given by orthogonal projection onto <span class="math inline">\(L^2(\mathcal{G})\)</span> as in <a href="#thm-cond-exp-proj" class="quarto-xref">Theorem&nbsp;6</a>, we must have</p>
<p><span class="math display">\[
\langle X - E(X \mid \mathcal{G}), Y I_B \rangle = 0.
\]</span></p>
<p>However, this inner product is</p>
<p><span class="math display">\[
\langle X - E(X \mid \mathcal{G}), Y I_B \rangle = \int_B \left[XY - Y E(X \mid \mathcal{G})\right] \ dP,
\]</span></p>
<p>so we get</p>
<p><span class="math display">\[
\int_B XY \ dP = \int_B Y E(X \mid \mathcal{G}) \ dP.
\]</span></p>
<p>This completes the proof.</p>
</div>
</div>
</div>
<p>The pull-out property shows that <span class="math inline">\(\mathcal{G}\)</span>-measurable factors can be extracted from conditional expectations. But what happens when we have a nested sequence of algebras <span class="math inline">\(\mathcal{G} \subset \mathcal{H} \subset \mathcal{F}\)</span>, representing increasingly refined information states?</p>
<p>Intuitively, if we first condition on the finer information <span class="math inline">\(\mathcal{H}\)</span> and then “forget” some information by conditioning on the coarser <span class="math inline">\(\mathcal{G}\)</span>, we should get the same result as conditioning directly on <span class="math inline">\(\mathcal{G}\)</span>. This is the content of the following property (also called the <em>law of iterated expectations</em>):</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-tower" class="theorem">
<p><span class="theorem-title"><strong>Theorem 10 (Tower property)</strong></span> Let <span class="math inline">\((\Omega, \mathcal{F}, P)\)</span> be a finite probability space, and let <span class="math inline">\(\mathcal{G} \subset \mathcal{H} \subset \mathcal{F}\)</span> be subalgebras. If <span class="math inline">\(X \in L^2(\mathcal{F})\)</span> is a random variable, then</p>
<p><span id="eq-tower"><span class="math display">\[
E(E(X \mid \mathcal{H}) \mid \mathcal{G}) = E(X \mid \mathcal{G}).
\tag{7}\]</span></span></p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Proof.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We have the inclusion of vector subspaces</p>
<p><span class="math display">\[
L^2(\mathcal{G}) \subset L^2(\mathcal{H}) \subset L^2(\mathcal{F}).
\]</span></p>
<p>If we choose the versions of the conditional expectations given by orthogonal projection as in <a href="#thm-cond-exp-proj" class="quarto-xref">Theorem&nbsp;6</a>, then the left-hand side of (<a href="#eq-tower" class="quarto-xref">7</a>) is the orthogonal projection of <span class="math inline">\(X\)</span> onto <span class="math inline">\(L^2(\mathcal{H})\)</span> followed by the orthogonal projection onto <span class="math inline">\(L^2(\mathcal{G})\)</span>. However, since the subspaces are nested, this composition is simply the orthogonal projection of <span class="math inline">\(X\)</span> onto <span class="math inline">\(L^2(\mathcal{G})\)</span>, which is the right-hand side of the desired equation.</p>
</div>
</div>
</div>
</section>
<section id="return-to-the-coin-flip-with-momentum" class="level2">
<h2 class="anchored" data-anchor-id="return-to-the-coin-flip-with-momentum">Return to the coin flip with momentum</h2>
<div id="f1b6c12c" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>mc.generate_sample_space(trajectory_length<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>print_html_df(df<span class="op">=</span>mc.omega, title<span class="op">=</span><span class="st">"probability space for coin flips with momentum"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="19">
<style type="text/css">
#T_fb4d5 th {
  text-align: right;
  width: 80px;
}
#T_fb4d5_row0_col0, #T_fb4d5_row0_col1, #T_fb4d5_row0_col2, #T_fb4d5_row0_col3, #T_fb4d5_row0_col4, #T_fb4d5_row1_col0, #T_fb4d5_row1_col1, #T_fb4d5_row1_col2, #T_fb4d5_row1_col3, #T_fb4d5_row1_col4, #T_fb4d5_row2_col0, #T_fb4d5_row2_col1, #T_fb4d5_row2_col2, #T_fb4d5_row2_col3, #T_fb4d5_row2_col4, #T_fb4d5_row3_col0, #T_fb4d5_row3_col1, #T_fb4d5_row3_col2, #T_fb4d5_row3_col3, #T_fb4d5_row3_col4, #T_fb4d5_row4_col0, #T_fb4d5_row4_col1, #T_fb4d5_row4_col2, #T_fb4d5_row4_col3, #T_fb4d5_row4_col4, #T_fb4d5_row5_col0, #T_fb4d5_row5_col1, #T_fb4d5_row5_col2, #T_fb4d5_row5_col3, #T_fb4d5_row5_col4, #T_fb4d5_row6_col0, #T_fb4d5_row6_col1, #T_fb4d5_row6_col2, #T_fb4d5_row6_col3, #T_fb4d5_row6_col4, #T_fb4d5_row7_col0, #T_fb4d5_row7_col1, #T_fb4d5_row7_col2, #T_fb4d5_row7_col3, #T_fb4d5_row7_col4, #T_fb4d5_row8_col0, #T_fb4d5_row8_col1, #T_fb4d5_row8_col2, #T_fb4d5_row8_col3, #T_fb4d5_row8_col4, #T_fb4d5_row9_col0, #T_fb4d5_row9_col1, #T_fb4d5_row9_col2, #T_fb4d5_row9_col3, #T_fb4d5_row9_col4, #T_fb4d5_row10_col0, #T_fb4d5_row10_col1, #T_fb4d5_row10_col2, #T_fb4d5_row10_col3, #T_fb4d5_row10_col4, #T_fb4d5_row11_col0, #T_fb4d5_row11_col1, #T_fb4d5_row11_col2, #T_fb4d5_row11_col3, #T_fb4d5_row11_col4, #T_fb4d5_row12_col0, #T_fb4d5_row12_col1, #T_fb4d5_row12_col2, #T_fb4d5_row12_col3, #T_fb4d5_row12_col4, #T_fb4d5_row13_col0, #T_fb4d5_row13_col1, #T_fb4d5_row13_col2, #T_fb4d5_row13_col3, #T_fb4d5_row13_col4, #T_fb4d5_row14_col0, #T_fb4d5_row14_col1, #T_fb4d5_row14_col2, #T_fb4d5_row14_col3, #T_fb4d5_row14_col4, #T_fb4d5_row15_col0, #T_fb4d5_row15_col1, #T_fb4d5_row15_col2, #T_fb4d5_row15_col3, #T_fb4d5_row15_col4 {
  text-align: right;
  font-family: monospace;
  width: 80px;
}
</style>

<div id="T_fb4d5" class="quarto-float quarto-figure quarto-figure-center anchored" data-quarto-postprocess="true">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="T_fb4d5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: probability space for coin flips with momentum
</figcaption>
<div aria-describedby="T_fb4d5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="T_fb4d5" class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th id="T_fb4d5_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">X1</th>
<th id="T_fb4d5_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">X2</th>
<th id="T_fb4d5_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">X3</th>
<th id="T_fb4d5_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">X4</th>
<th id="T_fb4d5_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_fb4d5_row0_col0" class="data row0 col0">0</td>
<td id="T_fb4d5_row0_col1" class="data row0 col1">0</td>
<td id="T_fb4d5_row0_col2" class="data row0 col2">0</td>
<td id="T_fb4d5_row0_col3" class="data row0 col3">0</td>
<td id="T_fb4d5_row0_col4" class="data row0 col4">0.171500</td>
</tr>
<tr class="even">
<td id="T_fb4d5_row1_col0" class="data row1 col0">0</td>
<td id="T_fb4d5_row1_col1" class="data row1 col1">0</td>
<td id="T_fb4d5_row1_col2" class="data row1 col2">0</td>
<td id="T_fb4d5_row1_col3" class="data row1 col3">1</td>
<td id="T_fb4d5_row1_col4" class="data row1 col4">0.073500</td>
</tr>
<tr class="odd">
<td id="T_fb4d5_row2_col0" class="data row2 col0">0</td>
<td id="T_fb4d5_row2_col1" class="data row2 col1">0</td>
<td id="T_fb4d5_row2_col2" class="data row2 col2">1</td>
<td id="T_fb4d5_row2_col3" class="data row2 col3">0</td>
<td id="T_fb4d5_row2_col4" class="data row2 col4">0.021000</td>
</tr>
<tr class="even">
<td id="T_fb4d5_row3_col0" class="data row3 col0">0</td>
<td id="T_fb4d5_row3_col1" class="data row3 col1">0</td>
<td id="T_fb4d5_row3_col2" class="data row3 col2">1</td>
<td id="T_fb4d5_row3_col3" class="data row3 col3">1</td>
<td id="T_fb4d5_row3_col4" class="data row3 col4">0.084000</td>
</tr>
<tr class="odd">
<td id="T_fb4d5_row4_col0" class="data row4 col0">0</td>
<td id="T_fb4d5_row4_col1" class="data row4 col1">1</td>
<td id="T_fb4d5_row4_col2" class="data row4 col2">0</td>
<td id="T_fb4d5_row4_col3" class="data row4 col3">0</td>
<td id="T_fb4d5_row4_col4" class="data row4 col4">0.021000</td>
</tr>
<tr class="even">
<td id="T_fb4d5_row5_col0" class="data row5 col0">0</td>
<td id="T_fb4d5_row5_col1" class="data row5 col1">1</td>
<td id="T_fb4d5_row5_col2" class="data row5 col2">0</td>
<td id="T_fb4d5_row5_col3" class="data row5 col3">1</td>
<td id="T_fb4d5_row5_col4" class="data row5 col4">0.009000</td>
</tr>
<tr class="odd">
<td id="T_fb4d5_row6_col0" class="data row6 col0">0</td>
<td id="T_fb4d5_row6_col1" class="data row6 col1">1</td>
<td id="T_fb4d5_row6_col2" class="data row6 col2">1</td>
<td id="T_fb4d5_row6_col3" class="data row6 col3">0</td>
<td id="T_fb4d5_row6_col4" class="data row6 col4">0.024000</td>
</tr>
<tr class="even">
<td id="T_fb4d5_row7_col0" class="data row7 col0">0</td>
<td id="T_fb4d5_row7_col1" class="data row7 col1">1</td>
<td id="T_fb4d5_row7_col2" class="data row7 col2">1</td>
<td id="T_fb4d5_row7_col3" class="data row7 col3">1</td>
<td id="T_fb4d5_row7_col4" class="data row7 col4">0.096000</td>
</tr>
<tr class="odd">
<td id="T_fb4d5_row8_col0" class="data row8 col0">1</td>
<td id="T_fb4d5_row8_col1" class="data row8 col1">0</td>
<td id="T_fb4d5_row8_col2" class="data row8 col2">0</td>
<td id="T_fb4d5_row8_col3" class="data row8 col3">0</td>
<td id="T_fb4d5_row8_col4" class="data row8 col4">0.049000</td>
</tr>
<tr class="even">
<td id="T_fb4d5_row9_col0" class="data row9 col0">1</td>
<td id="T_fb4d5_row9_col1" class="data row9 col1">0</td>
<td id="T_fb4d5_row9_col2" class="data row9 col2">0</td>
<td id="T_fb4d5_row9_col3" class="data row9 col3">1</td>
<td id="T_fb4d5_row9_col4" class="data row9 col4">0.021000</td>
</tr>
<tr class="odd">
<td id="T_fb4d5_row10_col0" class="data row10 col0">1</td>
<td id="T_fb4d5_row10_col1" class="data row10 col1">0</td>
<td id="T_fb4d5_row10_col2" class="data row10 col2">1</td>
<td id="T_fb4d5_row10_col3" class="data row10 col3">0</td>
<td id="T_fb4d5_row10_col4" class="data row10 col4">0.006000</td>
</tr>
<tr class="even">
<td id="T_fb4d5_row11_col0" class="data row11 col0">1</td>
<td id="T_fb4d5_row11_col1" class="data row11 col1">0</td>
<td id="T_fb4d5_row11_col2" class="data row11 col2">1</td>
<td id="T_fb4d5_row11_col3" class="data row11 col3">1</td>
<td id="T_fb4d5_row11_col4" class="data row11 col4">0.024000</td>
</tr>
<tr class="odd">
<td id="T_fb4d5_row12_col0" class="data row12 col0">1</td>
<td id="T_fb4d5_row12_col1" class="data row12 col1">1</td>
<td id="T_fb4d5_row12_col2" class="data row12 col2">0</td>
<td id="T_fb4d5_row12_col3" class="data row12 col3">0</td>
<td id="T_fb4d5_row12_col4" class="data row12 col4">0.056000</td>
</tr>
<tr class="even">
<td id="T_fb4d5_row13_col0" class="data row13 col0">1</td>
<td id="T_fb4d5_row13_col1" class="data row13 col1">1</td>
<td id="T_fb4d5_row13_col2" class="data row13 col2">0</td>
<td id="T_fb4d5_row13_col3" class="data row13 col3">1</td>
<td id="T_fb4d5_row13_col4" class="data row13 col4">0.024000</td>
</tr>
<tr class="odd">
<td id="T_fb4d5_row14_col0" class="data row14 col0">1</td>
<td id="T_fb4d5_row14_col1" class="data row14 col1">1</td>
<td id="T_fb4d5_row14_col2" class="data row14 col2">1</td>
<td id="T_fb4d5_row14_col3" class="data row14 col3">0</td>
<td id="T_fb4d5_row14_col4" class="data row14 col4">0.064000</td>
</tr>
<tr class="even">
<td id="T_fb4d5_row15_col0" class="data row15 col0">1</td>
<td id="T_fb4d5_row15_col1" class="data row15 col1">1</td>
<td id="T_fb4d5_row15_col2" class="data row15 col2">1</td>
<td id="T_fb4d5_row15_col3" class="data row15 col3">1</td>
<td id="T_fb4d5_row15_col4" class="data row15 col4">0.256000</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
<div id="85bbe17a" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the random variable S3 = X1 + X2 + X3</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> S3(omega):</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> omega[<span class="st">"X1"</span>] <span class="op">+</span> omega[<span class="st">"X2"</span>] <span class="op">+</span> omega[<span class="st">"X3"</span>]</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the conditional expectation of S3 given X1 and X2</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>cond_exp_S3_given_X1X2 <span class="op">=</span> conditional_exp(</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    omega<span class="op">=</span>mc.omega, RV<span class="op">=</span>S3, sigma_algebra<span class="op">=</span>[<span class="st">"X1"</span>, <span class="st">"X2"</span>], name<span class="op">=</span><span class="st">"E(S3 | X1, X2)"</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the conditional expectation</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>print_html_df(</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    df<span class="op">=</span>cond_exp_S3_given_X1X2,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"conditional expectation E(S3 | X1, X2)"</span>,</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="20">
<style type="text/css">
#T_5b26e th {
  text-align: right;
  width: 80px;
}
#T_5b26e_row0_col0, #T_5b26e_row0_col1, #T_5b26e_row0_col2, #T_5b26e_row1_col0, #T_5b26e_row1_col1, #T_5b26e_row1_col2, #T_5b26e_row2_col0, #T_5b26e_row2_col1, #T_5b26e_row2_col2, #T_5b26e_row3_col0, #T_5b26e_row3_col1, #T_5b26e_row3_col2 {
  text-align: right;
  font-family: monospace;
  width: 80px;
}
</style>

<div id="T_5b26e" class="quarto-float quarto-figure quarto-figure-center anchored" data-quarto-postprocess="true">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="T_5b26e-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: conditional expectation E(S3 | X1, X2)
</figcaption>
<div aria-describedby="T_5b26e-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="T_5b26e" class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th id="T_5b26e_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">X1</th>
<th id="T_5b26e_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">X2</th>
<th id="T_5b26e_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">E(S3 | X1, X2)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_5b26e_row0_col0" class="data row0 col0">0</td>
<td id="T_5b26e_row0_col1" class="data row0 col1">0</td>
<td id="T_5b26e_row0_col2" class="data row0 col2">0.300000</td>
</tr>
<tr class="even">
<td id="T_5b26e_row1_col0" class="data row1 col0">0</td>
<td id="T_5b26e_row1_col1" class="data row1 col1">1</td>
<td id="T_5b26e_row1_col2" class="data row1 col2">1.800000</td>
</tr>
<tr class="odd">
<td id="T_5b26e_row2_col0" class="data row2 col0">1</td>
<td id="T_5b26e_row2_col1" class="data row2 col1">0</td>
<td id="T_5b26e_row2_col2" class="data row2 col2">1.300000</td>
</tr>
<tr class="even">
<td id="T_5b26e_row3_col0" class="data row3 col0">1</td>
<td id="T_5b26e_row3_col1" class="data row3 col1">1</td>
<td id="T_5b26e_row3_col2" class="data row3 col2">2.800000</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
<p>We have a submartingale!</p>
<div id="57c2ba95" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the random variable S2 = X1 + X2</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> S2(omega):</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> omega[<span class="st">"X1"</span>] <span class="op">+</span> omega[<span class="st">"X2"</span>]</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a copy of the sample space and compute S2</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>omega <span class="op">=</span> mc.omega.copy()</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>omega[<span class="st">"S2"</span>] <span class="op">=</span> omega.<span class="bu">apply</span>(S2, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># S2 is constant on the atoms of sigma(X1, X2), so we group</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># by X1 and X2 and get unique values of S2 by using first(). Then</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># we convert to a dataframe and turn the multi-index into columns.</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>S2 <span class="op">=</span> omega.groupby([<span class="st">"X1"</span>, <span class="st">"X2"</span>])[<span class="st">"S2"</span>].first().to_frame().reset_index()</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the comparison of E(S3 | X1,X2) to S2</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>print_html_df(</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    df<span class="op">=</span>cond_exp_S3_given_X1X2.merge(S2, on<span class="op">=</span>[<span class="st">"X1"</span>, <span class="st">"X2"</span>]),</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"comparing E(S3 | X1,X2) to S2"</span>,</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="21">
<style type="text/css">
#T_06990 th {
  text-align: right;
  width: 80px;
}
#T_06990_row0_col0, #T_06990_row0_col1, #T_06990_row0_col2, #T_06990_row0_col3, #T_06990_row1_col0, #T_06990_row1_col1, #T_06990_row1_col2, #T_06990_row1_col3, #T_06990_row2_col0, #T_06990_row2_col1, #T_06990_row2_col2, #T_06990_row2_col3, #T_06990_row3_col0, #T_06990_row3_col1, #T_06990_row3_col2, #T_06990_row3_col3 {
  text-align: right;
  font-family: monospace;
  width: 80px;
}
</style>

<div id="T_06990" class="quarto-float quarto-figure quarto-figure-center anchored" data-quarto-postprocess="true">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="T_06990-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: comparing E(S3 | X1,X2) to S2
</figcaption>
<div aria-describedby="T_06990-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="T_06990" class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th id="T_06990_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">X1</th>
<th id="T_06990_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">X2</th>
<th id="T_06990_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">E(S3 | X1, X2)</th>
<th id="T_06990_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">S2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_06990_row0_col0" class="data row0 col0">0</td>
<td id="T_06990_row0_col1" class="data row0 col1">0</td>
<td id="T_06990_row0_col2" class="data row0 col2">0.300000</td>
<td id="T_06990_row0_col3" class="data row0 col3">0.000000</td>
</tr>
<tr class="even">
<td id="T_06990_row1_col0" class="data row1 col0">0</td>
<td id="T_06990_row1_col1" class="data row1 col1">1</td>
<td id="T_06990_row1_col2" class="data row1 col2">1.800000</td>
<td id="T_06990_row1_col3" class="data row1 col3">1.000000</td>
</tr>
<tr class="odd">
<td id="T_06990_row2_col0" class="data row2 col0">1</td>
<td id="T_06990_row2_col1" class="data row2 col1">0</td>
<td id="T_06990_row2_col2" class="data row2 col2">1.300000</td>
<td id="T_06990_row2_col3" class="data row2 col3">1.000000</td>
</tr>
<tr class="even">
<td id="T_06990_row3_col0" class="data row3 col0">1</td>
<td id="T_06990_row3_col1" class="data row3 col1">1</td>
<td id="T_06990_row3_col2" class="data row3 col2">2.800000</td>
<td id="T_06990_row3_col3" class="data row3 col3">2.000000</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
</section>
<section id="bibliography" class="level2">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">Bibliography</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Axler1997" class="csl-entry" role="listitem">
Axler, S. 1997. <em>Linera Algebra Done Right</em>. Second. Undergraduate Texts in Mathematics. Springer.
</div>
<div id="ref-Kallenberg2021" class="csl-entry" role="listitem">
Kallenberg, O. 2021. <em>Foundations of Modern Probability</em>. Third. Vol. 99. Probability Theory and Stochastic Modelling. Springer.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/johnmyers-phd\.com");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>