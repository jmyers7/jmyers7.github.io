---
title: "Diffusion"
# date: "2026-01-22"
toc: true
# categories: [Operator theory, Operator algebras, Functional analysis, C*-algebras, Spectral theorem, Hilbert spaces]
draft: true
# include-in-header: 
#   - file: /Users/johnmyers/dev/johnmyers-phd/posts/fd-operator/commands.tex
---

```{python}
# | echo: true
# | code-fold: true
# | fig-align: center

from sigalg.processes import RandomWalk
import matplotlib.pyplot as plt


plt.style.use("../../aux-files/custom-theme.mplstyle")
yellow = "#FFC300"
blue = "#3399FF"
teal = "#00CCA3"
purple = "#AA77CC"

X = RandomWalk(p=0.65, name="X", is_discrete_time=True).from_simulation(
    n_trajectories=10, length=200, random_state=42
)
X.plot_trajectories()
plt.show()

```

```{python}
# | echo: true
# | code-fold: true
# | fig-align: center

from matplotlib.colors import LinearSegmentedColormap


X = RandomWalk(p=0.65, name="X", is_discrete_time=True).from_simulation(
    n_trajectories=10_000, length=200, random_state=42
)

_, ax = plt.subplots(figsize=(6, 5))

n_plots = 8
time_step = 25  # 200 = 8 * 25

times = [time_step * k for k in range(1, n_plots + 1)]
cmap = LinearSegmentedColormap.from_list(
    "conditional_cmap", [yellow, purple, blue]
)
colors = [cmap(i / (n_plots - 1)) for i in range(n_plots)]

for color, t in zip(colors, times):
    probabilities = X[t - 1].range.probability_measure.data
    probabilities.index = X[t - 1].range.data.values

    ax.bar(
        x=probabilities.index,
        height=-probabilities.values * 175,
        width=0.8,
        color=color,
        bottom=t,
    )

ax.invert_yaxis()
ax.set_xlabel("state")
ax.set_ylabel("time")
ax.set_title(
    "time-evolution of the probability distribution\n(10,000 simulated trajectories)"
)
plt.tight_layout()
plt.show()

```