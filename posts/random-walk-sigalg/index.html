<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Building random walks in SigAlg – john myers, ph.d.</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../img/fav.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-367851019e9ccd243b94edaf001a4bfd.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-a20a51d952f05018587ef02e289faf91.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-VWK3RHBGT2"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-VWK3RHBGT2', { 'anonymize_ip': true});
</script>
</head><body class="nav-fixed quarto-light">$$
\newcommand{\bbc}{\mathbb{C}}
\newcommand{\bbr}{\mathbb{R}}

\newcommand{\cala}{\mathcal{A}}
\newcommand{\calb}{\mathcal{B}}
\newcommand{\calh}{\mathcal{H}}
\newcommand{\calk}{\mathcal{K}}
\newcommand{\calm}{\mathcal{M}}
\newcommand{\calv}{\mathcal{V}}
\newcommand{\cals}{\mathcal{S}}
\newcommand{\calx}{\mathcal{X}}

\newcommand{\mfP}{\mathcal{P}}

\newcommand{\d}{\textnormal{d}}
\newcommand{\id}{\boldsymbol{1}}
\newcommand{\zero}{\boldsymbol{0}}

\newcommand{\defeq}{\overset{\textnormal{def}}{=}}

\newcommand{\ang}[1]{\left\langle{#1}\right\rangle}
\newcommand{\norm}[1]{\lVert{#1\rVert}}
$$
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&amp;family=IBM+Plex+Sans:ital,wght@0,100..700;1,100..700&amp;family=Nunito:ital,wght@0,200..1000;1,200..1000&amp;display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>





<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">about</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../writings.html"> 
<span class="menu-text">writings</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-teaching" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">teaching</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-teaching">    
        <li>
    <a class="dropdown-item" href="../../teaching/multi-calc-sp-26/multi-calc-sp-26.html">
 <span class="dropdown-text">Multivariable Calculus</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../teaching/pde-sp-26/pde-sp-26.html">
 <span class="dropdown-text">Partial Differential Equations</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="https://www.johnmyers-phd.com/book" target="_blank"> 
<span class="menu-text">probabilistic machine learning</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jmyers7/" target="_blank"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/john-myers-phd" target="_blank"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:jmmyers25@gmail.com"> <i class="bi bi-envelope-open-fill" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#building-a-random-walk-in-sigalg" id="toc-building-a-random-walk-in-sigalg" class="nav-link active" data-scroll-target="#building-a-random-walk-in-sigalg">Building a random walk in SigAlg</a></li>
  <li><a href="#time-evolution-of-transition-probabilities-diffusion" id="toc-time-evolution-of-transition-probabilities-diffusion" class="nav-link" data-scroll-target="#time-evolution-of-transition-probabilities-diffusion">Time-evolution of transition probabilities: diffusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Building random walks in SigAlg</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="building-a-random-walk-in-sigalg" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="building-a-random-walk-in-sigalg">Building a random walk in SigAlg</h2>
<p>First, we recall that a <em>stochastic process</em> (or simply, a <em>process</em>), with index set <span class="math inline">\(T \subset \mathbb{R}\)</span>, is a function</p>
<p><span class="math display">\[
X: T \times \Omega \to \mathbb{R},
\]</span></p>
<p>where <span class="math inline">\(\Omega\)</span> is a probability space and each function</p>
<p><span class="math display">\[
X_t \stackrel{\text{def}}{=} X(t,-): \Omega \to \mathbb{R}, \quad \omega \mapsto X(t,\omega),
\]</span></p>
<p>for all <span class="math inline">\(t\in T\)</span>, is a random variable on <span class="math inline">\(\Omega\)</span> (i.e., a measurable function). Thus, a stochastic process can be viewed as a collection of random variables indexed by the set <span class="math inline">\(T\)</span>.</p>
<p>The set <span class="math inline">\(T\)</span> is often referred to as <em>time</em>, and when <span class="math inline">\(T\)</span> is countable we say that <span class="math inline">\(X\)</span> is a <em>discrete-time</em> stochastic process, while when <span class="math inline">\(T\)</span> is an interval in <span class="math inline">\(\mathbb{R}\)</span> we say that <span class="math inline">\(X\)</span> is a <em>continuous-time</em> stochastic process. Similarly, if each random variable <span class="math inline">\(X_t\)</span> is discrete, we say that <span class="math inline">\(X\)</span> is a <em>discrete-state</em> stochastic process, while if each <span class="math inline">\(X_t\)</span> is continuous, we say that <span class="math inline">\(X\)</span> is a <em>continuous-state</em> stochastic process.</p>
<p>By holding a sample point <span class="math inline">\(\omega\in \Omega\)</span> fixed and letting <span class="math inline">\(t\)</span> vary over the index set <span class="math inline">\(T\)</span>, we obtain a real-valued function</p>
<p><span class="math display">\[
X(\omega) \stackrel{\text{def}}{=} X(-, \omega): T\to \mathbb{R}, \quad t\mapsto X(t,\omega) \in \mathbb{R}
\]</span></p>
<p>which is called a <em>trajectory</em> (or <em>sample path</em>) of the stochastic process <span class="math inline">\(X\)</span>. Thus, a stochastic process can also be thought of as a collection of trajectories indexed by the sample space <span class="math inline">\(\Omega\)</span>.</p>
<p>Perhaps the simplest example of a stochastic process is an <em>independent and identically distributed</em> (IID) process, where each random variable <span class="math inline">\(X_t\)</span> is independent from all other random variables <span class="math inline">\(X_s\)</span> for <span class="math inline">\(s \neq t\)</span>, and all random variables <span class="math inline">\(X_t\)</span> have the same probability distribution. A simple example of an IID process is a sequence of Bernoulli random variables indexed by a finite set <span class="math inline">\(T = \{1,2,\ldots,n\}\)</span>, which can be used to model a sequence of <span class="math inline">\(n\)</span> coin flips where <span class="math inline">\(X_t = 1\)</span> represents heads and <span class="math inline">\(X_t = 0\)</span> represents tails on the <span class="math inline">\(t\)</span>-th flip. Such a process can be implemented using the SigAlg library and its interface with SciPy:</p>
<div id="a36d1663" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> bernoulli</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sigalg.core <span class="im">import</span> Time</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sigalg.processes <span class="im">import</span> IIDProcess</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct time index</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> Time.discrete(length<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the parameters for the IID process</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> IIDProcess(</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    distribution<span class="op">=</span>bernoulli(p<span class="op">=</span><span class="fl">0.7</span>),</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    support<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    time<span class="op">=</span>T,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate all possible trajectories</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>X.from_enumeration()</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Stochastic process 'X':
time        0  1  2
trajectory         
0           0  0  0
1           0  0  1
2           0  1  0
3           0  1  1
4           1  0  0
5           1  0  1
6           1  1  0
7           1  1  1</code></pre>
</div>
</div>
<p>The printout shows an IID process <span class="math inline">\(X\)</span> on the index set <span class="math inline">\(T = \{0,1,2\}\)</span>, where each <span class="math inline">\(X_t\)</span> is a Bernoulli random variable with parameter <span class="math inline">\(p=0.7\)</span>. Since each <span class="math inline">\(X_t\)</span> has only two possible outcomes, the entire process has <span class="math inline">\(2^3 = 8\)</span> possible trajectories, all being listed in the printout.</p>
<p>Each trajectory <span class="math inline">\(X(\omega)\)</span> of the process has a probability, computed as the product of the probabilities of each individual random variable along the trajectory:</p>
<p><span class="math display">\[
P(X(\omega)) = \prod_{t=0}^2 P(X_t = X(t,\omega)).
\]</span></p>
<p>(This uses the independence of the random variables <span class="math inline">\(X_t\)</span> in the IID process.) For example, for the trajectory <span class="math inline">\(\omega_3\)</span> (corresponding to trajectory <code>3</code> in the printout above) we have</p>
<p><span class="math display">\[
P(X(\omega_3)) = P(X_0 = 0) P(X_1 = 1) P(X_2 = 1) = 0.3 \cdot 0.7^2 = 0.147.
\]</span></p>
<p>The probabilities of each trajectory can be accessed via the <code>probability_measure</code> attribute of the process:</p>
<div id="c3bec8e1" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>P_X <span class="op">=</span> X.probability_measure.with_name(<span class="st">"P_X"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(P_X)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Probability measure 'P_X':
            probability
trajectory             
0                 0.027
1                 0.063
2                 0.063
3                 0.147
4                 0.063
5                 0.147
6                 0.147
7                 0.343</code></pre>
</div>
</div>
<p>Longer trajectories can be generated by increasing the <code>length</code> parameter in the <code>Time</code> instance, though care must be taken since the number of possible trajectories grows exponentially with the length of the process. For long processes, it is often more practical to work with simulations or samples of trajectories rather than enumerating all possible trajectories. In the next code block, we simulate a single trajectory of length 100 from the same IID Bernoulli process above and plot it:</p>
<div id="727b4bf2" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">"../../aux-files/custom-theme.mplstyle"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the time index of the process to a longer length</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> Time.discrete(length<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>X.time <span class="op">=</span> T</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate a single trajectory</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>X.from_simulation(</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    n_trajectories<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">42</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the trajectory</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>_, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="dv">2</span>))</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>X.plot_trajectories(ax<span class="op">=</span>ax)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-4-output-1.png" class="quarto-figure quarto-figure-center figure-img" width="613" height="252"></p>
</figure>
</div>
</div>
</div>
<p>Of course, the trajectory is actually a collection of points at either <span class="math inline">\(0\)</span> or <span class="math inline">\(1\)</span> along the vertical axis, but the plot connects these points with lines for visual clarity.</p>
<p>Now, let <span class="math inline">\(n\)</span> be a positive integer, <span class="math inline">\(a\)</span> a real number, and <span class="math inline">\(p\)</span> a real number in the interval <span class="math inline">\([0,1]\)</span>. A <em>random walk of length <span class="math inline">\(n\)</span>, beginning at <span class="math inline">\(a\)</span>,</em> is a stochastic process <span class="math inline">\(X\)</span> indexed by <span class="math inline">\(T = \{1,2,\ldots,n\}\)</span> with the following properties:</p>
<ol type="1">
<li>The increments <span class="math display">\[
\Delta X_t \stackrel{\text{def}}{=} X_t - X_{t-1}, \quad t = 1,2,\ldots,n,
\]</span> are IID random variables. (We set <span class="math inline">\(X_0=a\)</span>.)</li>
<li>Each increment <span class="math inline">\(\Delta X_t\)</span> takes either the value <span class="math inline">\(1\)</span> or <span class="math inline">\(-1\)</span>, the former with probability <span class="math inline">\(p\)</span> and the latter with probability <span class="math inline">\(1-p\)</span>.</li>
</ol>
<p>Technically, this is a random walk <em>with drift</em>, since the expected value of each increment is <span class="math inline">\(E(\Delta X_t) = 2p - 1\)</span>, which is nonzero when <span class="math inline">\(p \neq 0.5\)</span>. When <span class="math inline">\(p = 0.5\)</span>, the random walk is said to be <em>symmetric</em>, since the expected value of each increment is zero.</p>
<p>The reason for the name “random walk” is that each trajectory <span class="math inline">\(X(\omega)\)</span> can be visualized as a path on the integer number line starting at the point <span class="math inline">\(a\)</span>, where at each discrete time a step is taken that moves either one unit to the right (with probability <span class="math inline">\(p\)</span>) or one unit to the left (with probability <span class="math inline">\(1-p\)</span>). Over many steps, this results in a “wandering” behavior that resembles a random walk. The random variable <span class="math inline">\(X_t\)</span> represents the position of the walk after <span class="math inline">\(t\)</span> steps.</p>
<p>The SigAlg library provides the <code>RandomWalk</code> class to model these processes, but it is instructive to build a random walk from scratch using the above recipe. To do this, note that each <span class="math inline">\(X_t\)</span> is the cumulative sum of the increments up to time <span class="math inline">\(t\)</span>, plus the initial state <span class="math inline">\(X_0 = a\)</span>:</p>
<div class="page-columns page-full"><p><span class="math display">\[
X_t = X_0 + \sum_{s=1}^t \Delta X_s.
\]</span> </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Notice the formal similarity between this equation and the the Fundamental Theorem of Calculus: <span class="math display">\[f(t) = f(0) + \int_0^tdf(s),\]</span> where we write <span class="math inline">\(df(s) = f'(s) \, ds\)</span>.</span></div></div>
<p>Thus, if we can model the increments <span class="math inline">\(\Delta X_t\)</span> as an IID process, we can then define the random walk <span class="math inline">\(X\)</span> as the cumulative sum of these increments plus the starting point <span class="math inline">\(a\)</span>. But, for each <span class="math inline">\(t\)</span>, we clearly have</p>
<p><span class="math display">\[
\Delta X_t = 2B_t -1,
\]</span></p>
<p>where <span class="math inline">\(B_t\)</span> is a Bernoulli random variable with parameter <span class="math inline">\(p\)</span>. Therefore, with <span class="math inline">\(n=10\)</span>, <span class="math inline">\(a=0\)</span>, and <span class="math inline">\(p=0.7\)</span>, we can build a random walk process as follows, and then simulate 10 trajectories from it:</p>
<div id="c3b2f3d4" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sigalg.core <span class="im">import</span> RandomVariable</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> Time.discrete(length<span class="op">=</span><span class="dv">10</span>, start<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> IIDProcess(</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    distribution<span class="op">=</span>bernoulli(p<span class="op">=</span><span class="fl">0.7</span>),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    time<span class="op">=</span>T,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"B"</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>).from_simulation(</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    n_trajectories<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">42</span>,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Construc the increment process</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>Delta_X <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> B <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the initial state</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> RandomVariable(domain<span class="op">=</span>B.domain, name<span class="op">=</span><span class="dv">0</span>).from_constant(<span class="dv">0</span>)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>Delta_X.add_initial_state(a)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct the random walk process by cumulative summation</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> Delta_X.cumsum(name<span class="op">=</span><span class="st">"X"</span>)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Stochastic process 'X':
time        0   1   2   3   4   5   6   7   8   9   10
trajectory                                            
0            0  -1   0  -1   0   1   0  -1  -2  -1   0
1            0   1   0   1   0   1   2   3   4   3   4
2            0  -1   0  -1  -2  -3  -2  -1   0   1   2
3            0  -1  -2  -1   0   1   2   3   4   5   6
4            0   1   0  -1   0  -1  -2  -1   0   1   2
5            0   1   2   1   2   1   0   1   2   3   4
6            0   1   2   3   2   3   4   5   6   7   8
7            0   1   2   1   2   3   4   5   6   7   6
8            0   1   2   1   2   3   4   3   4   5   6
9            0   1   2   3   4   5   6   7   8   9   8</code></pre>
</div>
</div>
<p>So, for example, we see that the final position of trajectory <code>3</code> is <code>6</code>. A plot of these simulated trajectories is shown below:</p>
<div id="f9422a5d" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>yellow <span class="op">=</span> <span class="st">"#FFC300"</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>_, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="dv">3</span>))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>X.plot_trajectories(ax<span class="op">=</span>ax, colors<span class="op">=</span>[yellow], plot_kwargs<span class="op">=</span>{<span class="st">"alpha"</span>: <span class="fl">0.7</span>})</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-6-output-1.png" class="quarto-figure quarto-figure-center figure-img" width="622" height="329"></p>
</figure>
</div>
</div>
</div>
<p>Longer trajectories reveal the “drift” that we mentioned above. To make these longer trajectories, we use the built-in <code>RandomWalk</code> class in SigAlg, which internally implements the same construction as above. The following code simulates 10 trajectories of length 100 from a random walk with <span class="math inline">\(p=0.7\)</span> and plots them:</p>
<div id="62e479c1" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sigalg.processes <span class="im">import</span> RandomWalk</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> Time.discrete(length<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> RandomWalk(p<span class="op">=</span><span class="fl">0.7</span>, time<span class="op">=</span>T).from_simulation(</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    n_trajectories<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">42</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>_, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="dv">4</span>))</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>X.plot_trajectories(ax<span class="op">=</span>ax, colors<span class="op">=</span>[yellow], plot_kwargs<span class="op">=</span>{<span class="st">"alpha"</span>: <span class="fl">0.7</span>})</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-7-output-1.png" class="quarto-figure quarto-figure-center figure-img" width="622" height="406"></p>
</figure>
</div>
</div>
</div>
<p>While random, it is evident that the trajectories tend to drift upwards over time, since the expected increment is positive: <span class="math inline">\(E(\Delta X_t) = 2 \cdot 0.7 - 1 = 0.4 &gt; 0\)</span>.</p>
</section>
<section id="time-evolution-of-transition-probabilities-diffusion" class="level2">
<h2 class="anchored" data-anchor-id="time-evolution-of-transition-probabilities-diffusion">Time-evolution of transition probabilities: diffusion</h2>
<p>Imagine that, at time <span class="math inline">\(0\)</span>, you attempt to predict the future value <span class="math inline">\(X_t\)</span> of a random walk at some future time <span class="math inline">\(t\)</span>. From the plots of the trajectories immediately above, it is evident that your prediction will <em>always</em> be uncertain, and that this uncertainty grows larger as <span class="math inline">\(t\)</span> increases. The probability distribution that describes this uncertainty is exactly the law of the random variable <span class="math inline">\(X_t\)</span>, which we might write as</p>
<p><span class="math display">\[
P(X_t = x \mid X_0 = a)
\]</span></p>
<p>to emphasize that the random walk starts at <span class="math inline">\(X_0 = a\)</span>. When written like this, the law is understood as a <em>transition probability distribution</em>, since it gives the probabilities of transitioning from the state <span class="math inline">\(X_0 = a\)</span> at time <span class="math inline">\(0\)</span> to the various possible states <span class="math inline">\(X_t=x\)</span> at time <span class="math inline">\(t\)</span>. The fact that this probability distribution “spreads out” as <span class="math inline">\(t\)</span> increases is known as <em>diffusion</em>, and it is a fundamental property of random walks and many other stochastic processes.</p>
<p>In fact, if the random walk has probability parameter <span class="math inline">\(p\)</span>, then we have</p>
<p><span class="math display">\[
V(\Delta X_t) = V(2B_t - 1) = 4pq,
\]</span></p>
<p>where we set <span class="math inline">\(q=1-p\)</span>, and where <span class="math inline">\(B\)</span> is the IID Bernoulli process used to construct the increments in the previous section. Since the increments are independent, it then follows that</p>
<p><span id="eq-variance-random-walk"><span class="math display">\[
V(X_t) = \sum_{s=1}^t V(\Delta X_s) = 4tpq.
\tag{1}\]</span></span></p>
<p>Thus, the variances of a random walk grow linearly as a function of time <span class="math inline">\(t\)</span>. As for the expectations, we have <span id="eq-expectation-random-walk"><span class="math display">\[
E(X_t) = X_0 + \sum_{s=1}^t E(\Delta X_s) = X_0 + t(p-q),
\tag{2}\]</span></span></p>
<p>so the expectations also grow linearly as a function of time <span class="math inline">\(t\)</span>.</p>
<p>These observations, along with the plots in the previous section, suggest that the time-evolution of the law of <span class="math inline">\(X_t\)</span> consists of a “peak” that moves linearly with time (according to the expectation) while simultaneously diffusing (according to the variance).</p>
<p>This evolution may be observed experimentally in SigAlg, as shown in the following plot. We simulate 10,000 trajectories of a random walk with <span class="math inline">\(p=0.7\)</span> and then plots histograms of the values of <span class="math inline">\(X_t\)</span> for various <span class="math inline">\(t\)</span> in a “ridgeline” plot:</p>
<div id="e312e149" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.colors <span class="im">import</span> LinearSegmentedColormap</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>blue <span class="op">=</span> <span class="st">"#3399FF"</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>purple <span class="op">=</span> <span class="st">"#AA77CC"</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> Time.discrete(length<span class="op">=</span><span class="dv">200</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> RandomWalk(</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    p<span class="op">=</span><span class="fl">0.7</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"X"</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    time<span class="op">=</span>T,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>).from_simulation(</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    n_trajectories<span class="op">=</span><span class="dv">10_000</span>,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">42</span>,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>_, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="dv">5</span>))</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>n_plots <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>time_step <span class="op">=</span> <span class="dv">25</span>  <span class="co"># 200 = 8 * 25</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>times <span class="op">=</span> [time_step <span class="op">*</span> k <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n_plots <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>cmap <span class="op">=</span> LinearSegmentedColormap.from_list(<span class="st">"conditional_cmap"</span>, [yellow, purple, blue])</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [cmap(i <span class="op">/</span> (n_plots <span class="op">-</span> <span class="dv">1</span>)) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_plots)]</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> color, t <span class="kw">in</span> <span class="bu">zip</span>(colors, times):</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>    probabilities <span class="op">=</span> X[t <span class="op">-</span> <span class="dv">1</span>].<span class="bu">range</span>.probability_measure.data</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>    probabilities.index <span class="op">=</span> X[t <span class="op">-</span> <span class="dv">1</span>].<span class="bu">range</span>.data.values</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>    ax.bar(</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>probabilities.index,</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>        height<span class="op">=-</span>probabilities.values <span class="op">*</span> <span class="dv">175</span>,</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>        width<span class="op">=</span><span class="fl">0.8</span>,</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>color,</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>        bottom<span class="op">=</span>t,</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>ax.invert_yaxis()</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"state"</span>)</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"time"</span>)</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>ax.set_title(</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Time-evolution of the probability distribution</span><span class="ch">\n</span><span class="st">of a random walk"</span>,</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-8-output-1.png" class="quarto-figure quarto-figure-center figure-img" width="688" height="486"></p>
</figure>
</div>
</div>
</div>
<p>As we expected, the peak of the distribution drifts toward higher values as time increases, while simultaneously diffusing.</p>
<p>It is not difficult to write down a formula for the last of <span class="math inline">\(X_t\)</span>; in fact, we accomplish this in <a href="#thm-explicit-discrete-law" class="quarto-xref">Theorem&nbsp;2</a>. However, it is also possible to describe the time-evolution of the law of <span class="math inline">\(X_t\)</span> using a special <em>difference equation</em>, which is the discrete starting point for the Fokker-Planck partial differential equation that we will study later.</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-discrete-diffusion-equation" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1 (Discrete Diffusion Equation)</strong></span> Let <span class="math inline">\(X\)</span> be a random walk with probability parameter <span class="math inline">\(p\)</span>, starting at position <span class="math inline">\(a\)</span>, and write <span class="math inline">\(q=1-p\)</span>. If we write</p>
<p><span class="math display">\[
f(x,t) = P(X_t = x)
\]</span></p>
<p>for the probability function of <span class="math inline">\(X_t\)</span>, then for all integers <span class="math inline">\(t \geq 0\)</span> and all <span class="math inline">\(x \in \mathbb{Z}\)</span>, we have <span class="math display">\[
f(x,t+1) - f(x,t) = p \big( f(x-1,t) - f(x,t) \big) + q \big( f(x+1,t) - f(x,t) \big),
\]</span></p>
<p>along with the initial conditions <span class="math display">\[
f(a, 0) = 1, \quad f(x,0) = 0 \text{ for } x \neq a.
\]</span></p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Proof.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>From the law of total probability, we have</p>
<p><span class="math display">\[
P(X_{t+1}=x) = \sum_{y\in \mathbb{Z}} P(X_{t+1}=x \mid X_t = y) P(X_t = y).
\]</span></p>
<p>However, the conditional probabilities on the right-hand vanish except when <span class="math inline">\(y = x-1\)</span> or <span class="math inline">\(y = x+1\)</span>, since the random walk can only move one unit to the left or right at each time step. Thus, we have</p>
<p><span class="math display">\[
f(x,t+1) = p f(x-1,t) + q f(x+1,t).
\]</span></p>
<p>Then, if we subtract <span class="math inline">\(f(x,t)\)</span> from both sides and use that <span class="math inline">\(p+q=1\)</span>, we get</p>
<p><span class="math display">\[
f(x,t+1) - f(x,t) = p \big( f(x-1,t) - f(x,t) \big) + q \big( f(x+1,t) - f(x,t) \big),
\]</span></p>
<p>as claimed.</p>
</div>
</div>
</div>
<p>Thus, the (forward) time increment of the probability function <span class="math inline">\(f(x,t)\)</span> is given by a weighted sum of the spatial increments to the left and right, with weights given by the probabilities <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span>. We will see this same sort of structure in the Fokker-Planck equation, where a time derivative is equal to an expression involving spatial derivatives.</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-explicit-discrete-law" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2 (Law of Random Walk)</strong></span> Let <span class="math inline">\(X\)</span> be a random walk with probability parameter <span class="math inline">\(p\)</span>, starting position <span class="math inline">\(a\)</span>, and write <span class="math inline">\(q=1-p\)</span>. Then the probability function <span class="math inline">\(f(x,t)\)</span> of <span class="math inline">\(X_t\)</span> is given by the formula</p>
<p><span class="math display">\[
f(x,t) = \binom{t}{\frac{x-a+t}{2}} p^{\frac{x-a+t}{2}} q^{\frac{t-x+a}{2}},
\]</span></p>
<p>for all integers <span class="math inline">\(t\geq 0\)</span> and all</p>
<p><span class="math display">\[
x \in \{ a-t, a-t+2, a-t+4, \ldots, a+t \}.
\]</span></p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Proof.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>For each integer <span class="math inline">\(t\geq 1\)</span>, we have that</p>
<p><span class="math display">\[
X_t = a + \sum_{s=1}^t \Delta X_s = a + \sum_{s=1}^t (2B_s - 1) = a-t + 2Y,
\]</span></p>
<p>where <span class="math inline">\(Y\)</span> is a binomial random variable with parameters <span class="math inline">\(t\)</span> and <span class="math inline">\(p\)</span>. Then <span class="math inline">\(X_t=x\)</span> if and only if <span class="math inline">\(Y = \frac{x - a + t}{2}\)</span>, so the result follows from the probability function of the binomial distribution.</p>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/johnmyers-phd\.com");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>