---
title: "02 Separation of variables, part 1"
format:
    revealjs:
        incremental: true
        slide-number: true
        theme:
            - default
            - "../../aux-files/custom-slides.scss"
---

# Solving the heat equation

## A fact from ODEs {.scrollable}

::: {.callout-note icon="false" .fragment}
### General solutions to a special ODE
Let $f$ be a function with continuous first and second derivatives. Consider the differential equation
$$
f'' + af' + bf = 0,
$$
where $a$ and $b$ are constants. If $r_1$ and $r_2$ are the roots of the characteristic equation
$$
r^2 + ar + b = 0,
$$

then the general solution to the ODE is

$$
f( x ) = C_1 e^{r_1 x} + C_2 e^{r_2 x},
$$

where $C_1$ and $C_2$ are arbitrary constants determined by the initial and boundary conditions.
:::

- This ODE is called **homogeneous** because it has no terms that are functions of $x$ alone, i.e., the right-hand side is zero.

- This ODE is called **linear** because the differential operator on the left,
    $$
    L(f) = f'' + af' + bf,
    $$
    preserves linear combinations, i.e., we have $L(f+g)= L(f) + L(g)$ and $L(cf) = cL(f)$, for all functions $f$ and $g$ and any scalar $c$.

- This ODE is called **second-order** because the highest derivative that appears is the second derivative, $f''$.

- This ODE is called **constant-coefficient** because the coefficients $a$ and $b$ are constants, not functions of $x$.

::: {.callout-note icon="false" .fragment appearance="minimal"}

- The roots $r_1$ and $r_2$ might be complex! In this case, they are conjugates of each other:
    $$
    r_1 = \alpha + i\beta, \quad r_2 = \alpha - i\beta
    $$

- In this case, the general solution can be written as
    $$
    f(x) = e^{\alpha x} \left( C_1 \sin(\beta x) + C_2 \cos(\beta x) \right),
    $$
    where $C_1$ and $C_2$ are arbitrary constants.

:::

## Separation of variables, part 1 {.scrollable}

- Recall that the heat equation is $\displaystyle\frac{\partial u}{\partial t} = k \frac{\partial^2 u}{\partial x^2}$ where $k$ is a positive (known) constant.

- We assume the boundary conditions
$$
u(0,t) = 0, \quad u(L,t) = 0, \quad t > 0,
$$
where $L$ is some positive (known) constant.

- We ignore initial conditions for the moment.

::: {.callout-note icon="false" .fragment}
### The "separation of variables" strategy

- We look for solutions of the form
$$
u(x,t) = X(x)T(t),
$$
where $X$ is a function of $x$ alone and $T$ is a function of $t$ alone.
:::

- Substituting $u(x,t) = X(x)T(t)$ into the heat equation gives
$$
X(x) T'(t) = k T(t) X''(x),
$$
along with
$$
X(0) = 0, \quad X(L) = 0.
$$

## Separation of variables, part 2 {.scrollable}

- Dividing both sides of the equation by $k X(x) T(t)$ gives
$$
\frac{T'(t)}{k T(t)} = \frac{X''(x)}{X(x)}.
$$

- Notice that the left-hand side depends only on $t$ and the right-hand side depends only on $x$. Therefore, both sides must be equal to a constant, which we denote by $-\lambda$:
$$
\frac{T'(t)}{k T(t)} = \frac{X''(x)}{X(x)} = -\lambda.
$$

- This leads to a system of **two** ODEs:
$$
T'(t) = - k \lambda T(t)
$$
and
$$
X''(x) + \lambda X(x) = 0, \quad X(0) = 0, \quad X(L) = 0,
$$

- The general solution to the first ODE is
$$
T(t) = C_0 \exp\left(-k \lambda t\right),
$$
where $C_0$ is an arbitrary constant.

- The general solution to the second ODE is
$$
X(x) = C_1 \sin(\sqrt{\lambda} x) + C_2 \cos(\sqrt{\lambda} x),
$$
where $C_1$ and $C_2$ are arbitrary constants.

## Separation of variables, part 3 {.scrollable}

- But now the boundary condition $X(0)=0$ forces $C_2 = 0$, so
$$
X(x) = C_1 \sin(\sqrt{\lambda} x).
$$

- The boundary condition $X(L)=0$ then gives
$$
C_1 \sin(\sqrt{\lambda} L) = 0.
$$

- Since $C_1 \neq 0$ (otherwise the solution is trivial), we must have
$$
\sin(\sqrt{\lambda} L) = 0,
$$
which implies
$$
\sqrt{\lambda} L = n \pi, \quad n = \pm 1, \pm 2, \pm3, \dots
$$
Therefore,
$$
\lambda = \left( \frac{n \pi}{L} \right)^2.
$$

- Therefore, for each $n=1,2,3,\dots$ (we ignore the negative valuesâ€”why?), we have a solution
$$
X_n(x) = C_1 \sin\left( \frac{n \pi x}{L} \right).
$$

- Combining this with $T(t)$, we obtain the solutions to the heat equation
$$
u_n(x,t) = \exp\left(\frac{-n^2 \pi^2 kt}{L^2} \right) \sin\left( \frac{n \pi x}{L} \right),
$$

one for each $n=1,2,3,\ldots$.

## Separation of variables, part 4 {.scrollable}

- Since sums and scalar multiples of solutions to the heat equation are also solutions, we are led to believe that perhaps the infinite sum of solutions
$$
u(x,t) = \sum_{n=1}^{\infty} a_n \exp\left(\frac{-n^2 \pi^2 kt}{L^2} \right) \sin\left( \frac{n \pi x}{L} \right)
$$
is also a solution, where $a_n$ are constants.